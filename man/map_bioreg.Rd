% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/map_bioreg.R
\name{map_bioreg}
\alias{map_bioreg}
\title{Map bioregion clusters and interpolate spatial assignments}
\usage{
map_bioreg(data, scale_cols, clus_method = "all", plot = TRUE, interp = "both")
}
\arguments{
\item{data}{A \code{data.frame} containing at least coordinate columns (\code{x}, \code{y}) and the
variables specified in \code{scale_cols} to be used for clustering.}

\item{scale_cols}{Character vector of column names in \code{data} to scale before clustering.}

\item{clus_method}{Character; clustering method(s) to apply. One of:
\describe{
\item{"kmeans"}{k-means clustering}
\item{"pam"}{Partitioning Around Medoids}
\item{"hclust"}{Hierarchical clustering (complete linkage)}
\item{"gmm"}{Gaussian Mixture Model clustering}
\item{"all"}{All of the above methods}
}
Default is "all".}

\item{plot}{Logical; if \code{TRUE}, produces side-by-side cluster maps for each method. Default is \code{TRUE}.}

\item{interp}{Character; interpolation method for raster assignment. One of:
\describe{
\item{"NN"}{nearest-neighbor interpolation}
\item{"Tps"}{thin-plate spline interpolation}
\item{"both"}{both NN and Tps}
}
Default is "both".}
}
\value{
A list with elements:
\item{data}{Original data with appended cluster assignment columns (\code{kmeans_opt}, \code{pam_opt_aligned}, etc.)}
\item{interpolated}{A \code{SpatRaster} or stack of rasters of interpolated cluster assignments}
\item{clusters}{A \code{SpatRaster} of discretized cluster classes after interpolation}
}
\description{
Performs clustering on scaled variables to delineate bioregions, aligns cluster labels
across methods, generates comparative cluster maps, and interpolates cluster assignments
over a raster grid using nearest-neighbor (NN) and/or thin-plate spline (Tps) methods.
}
\details{
\enumerate{
\item Scales the columns in \code{scale_cols} using \code{scale()}.
\item If \code{clus_method} includes "kmeans", automatically determines optimal k via
\code{NbClust::NbClust()} (silhouette index, k = 2â€“10).
\item Applies each requested clustering method, aligns non-kmeans labels to kmeans reference.
\item If \code{plot = TRUE}, generates comparative cluster maps using \code{ggplot2} and \code{patchwork}.
\item If \code{interp} includes "NN", assigns each raster cell the cluster of its nearest point.
\item If \code{interp} includes "Tps", fits thin-plate spline surfaces (via \code{fields::Tps()}) for each
cluster layer and predicts over the raster grid.
}
}

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Workflow for Compositional Dissimilarity and Biodiversity Turnover Analysis • dissmapr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/PT_Sans-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Workflow for Compositional Dissimilarity and Biodiversity Turnover Analysis">
<meta name="description" content="Tools to compute and map biodiversity turnover at the macroscale.">
<meta property="og:description" content="Tools to compute and map biodiversity turnover at the macroscale.">
<meta property="og:image" content="https://macsands.github.io/dissmapr/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">dissmapr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/getting-started.html">getting-started</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://b-cubed.eu/" aria-label="B-Cubed website"><span class="fa fa-cube"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/macSands/dissmapr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><ul>
<li>
<a href="#dissmapr"><code>dissmapr: Compositional Dissimilarity and Biodiversity Turnover Analysis</code></a><br>
</li>
<li><a href="#introduction">Introduction</a></li>
<li>
<a href="#step-by-step-workflow">Step-by-Step Workflow</a>
<ul>
<li><a href="#id_1-install-and-load-dissmapr">1. Install and load <code>dissmapr</code></a></li>
<li><a href="#id_2-load-other-r-libraries">2. Load other R libraries</a></li>
<li><a href="#id_3-user-defined-area-of-interest-and-grid-resolution">3. User-defined area of interest and grid resolution</a></li>
<li><a href="#id_4-get-species-occurrence-records-using-get_occurrence_data">4. Get species occurrence records using <code>get_occurrence_data</code></a></li>
<li><a href="#id_5-format-data-using-format_df">5. Format data using <code>format_df</code></a></li>
<li>
<a href="#id_6-summarise-records-by-grid-centroid-using-generate_grid">6. Summarise records by grid centroid using <code>generate_grid</code></a>
<ul>
<li><a href="#example-1---species-richness">Example 1 – Species Richness</a></li>
<li><a href="#example-2---community-turnover">Example 2 – Community Turnover</a></li>
</ul>
</li>
<li><a href="#id_7-generate-site-by-species-matrix---site_spp">7. Generate site by species matrix - <code>site_spp</code></a></li>
<li><a href="#id_8-generate-site-by-environment-matrix-using-get_enviro_data">8. Generate site by environment matrix using <code>get_enviro_data</code></a></li>
<li><a href="#id_9-change-coordinates-projection-using-sfst_transform">9. Change coordinates projection using <code>sf::st_transform</code></a></li>
<li><a href="#id_10-check-for-colinearity-using-rm_correlated">10. Check for colinearity using <code>rm_correlated</code></a></li>
<li><a href="#id_11-calculate-zeta-decline-for-orders-215">11. Calculate Zeta decline for orders 2:15</a></li>
<li><a href="#id_12-calculate-zeta-decay-for-orders-28">12. Calculate Zeta decay for orders 2:8</a></li>
<li><a href="#id_13-run-a-multi-site-generalised-dissimilarity-model-for-order-2">13. Run a Multi-Site Generalised Dissimilarity Model for order 2</a></li>
<li><a href="#id_14-predict-current-zeta-diversity-zeta2-using-predict_dissim">14. Predict current Zeta Diversity (zeta2) using <code>predict_dissim</code></a></li>
<li><a href="#id_15-run-clustering-analyses-using-map_bioreg">15. Run clustering analysesusing <code>map_bioreg</code></a></li>
<li><a href="#id_16-predict-future-zeta-diversity-and-map-bioregion-change-using-map_bioregDiff">16. Predict future Zeta Diversity and map bioregion change using <code>map_bioregDiff</code></a></li>
<li><a href="#id_17-deposit-all-results-into-Zenodo">17. Deposit all results into Zenodo</a></li>
</ul>
</li>
</ul>
<!-- README.md is generated from README.Rmd. Please edit that file --><!-- badges: start -->
<!-- badges: end -->
<hr>
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="dissmapr">
<code>dissmapr</code><a class="anchor" aria-label="anchor" href="#dissmapr"></a>
</h1>
</div>
<div class="section level2">
<h2 id="a-novel-framework-for-automated-compositional-dissimilarity-and-biodiversity-turnover-analysis">A Novel Framework for Automated Compositional Dissimilarity and Biodiversity Turnover Analysis<a class="anchor" aria-label="anchor" href="#a-novel-framework-for-automated-compositional-dissimilarity-and-biodiversity-turnover-analysis"></a>
</h2>
<hr>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>dissmapr</code> is an R package for analysing compositional dissimilarity and biodiversity turnover across spatial gradients. It provides scalable, modular workflows that integrate species occurrence, environmental data, and multi-site metrics to quantify and predict biodiversity patterns. A core feature is the use of zeta diversity, which extends beyond pairwise comparisons to capture shared species across multiple sites—offering deeper insight into community assembly, turnover, and connectivity. By incorporating modern approaches such as multi-site Generalised Dissimilarity Modelling (MS-GDM), <code>dissmapr</code> enables robust mapping, bioregional classification, and scenario-based forecasting. Designed for flexibility and reproducibility, it supports biodiversity monitoring and conservation planning at landscape to regional scales.</p>
<hr>
</div>
<div class="section level2">
<h2 id="step-by-step-workflow">Step-by-Step Workflow<a class="anchor" aria-label="anchor" href="#step-by-step-workflow"></a>
</h2>
<p><code>dissmapr</code> implements a structured, reproducible workflow for analysing biodiversity patterns and delineating bioregions. Each function aligns with a specific step, guiding users from data acquisition to predictive mapping. The workflow begins with sourcing species occurrence and georeferenced environmental data, followed by data formatting and calculation of compositional turnover using zeta diversity metrics (via the <code>zetadiv</code> package). Multi-Site Generalized Dissimilarity Modelling (MS-GDM) is then applied to model and predict dissimilarity across landscapes. These predictions feed into the Dissimilarity Cube, which classifies spatial clusters of species composition into distinct bioregions. The framework supports the integration of historical and future climate data to assess shifts in biodiversity and detect emerging, shifting, or dissolving bioregions under global change. This step-by-step structure, mirrored in the accompanying tutorial sections, promotes accessibility, transparency, and ecological insight at multiple spatial and temporal scales.</p>
<hr>
<div class="section level3">
<h3 id="id_1-install-and-load-dissmapr">1. Install and load <code>dissmapr</code>
<a class="anchor" aria-label="anchor" href="#id_1-install-and-load-dissmapr"></a>
</h3>
<p>Install and load the <code>dissmapr</code> package from GitHub, ensuring all functions are available for use in the analysis workflow.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install remotes if needed</span></span>
<span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"macSands/dissmapr"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure the package is loaded when knitting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/macSands/dissmapr" class="external-link">dissmapr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make sure all the functions are loaded</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="id_2-load-other-r-libraries">2. Load other R libraries<a class="anchor" aria-label="anchor" href="#id_2-load-other-r-libraries"></a>
</h3>
<p>Load core libraries for spatial processing, biodiversity modelling, and visualization required across the <code>dissmapr</code> analysis pipeline.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/" class="external-link">httr</a></span><span class="op">)</span>       <span class="co"># HTTP client  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geodata</span><span class="op">)</span>    <span class="co"># Download geographic data  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span> <span class="co"># Fast large-table operations  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>      <span class="co"># Data manipulation verbs  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>      <span class="co"># Tidy data reshaping  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zoo.R-Forge.R-project.org/" class="external-link">zoo</a></span><span class="op">)</span>        <span class="co"># Time series utilities  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>         <span class="co"># Vector spatial data  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span>      <span class="co"># Raster spatial operations  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">zetadiv</span><span class="op">)</span>    <span class="co"># Multi-site biodiversity turnover  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>    <span class="co"># Grammar of graphics  </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span>    <span class="co"># Perceptual color scales  </span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="id_3-user-defined-area-of-interest-and-grid-resolution">3. User-defined area of interest and grid resolution<a class="anchor" aria-label="anchor" href="#id_3-user-defined-area-of-interest-and-grid-resolution"></a>
</h3>
<p>Load the spatial boundary data for South Africa to serve as the geographic reference for all subsequent biodiversity analyses and visualizations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read RSA shape file</span></span>
<span><span class="va">rsa</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">'inst/extdata/rsa.shp'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `rsa' from data source </span></span>
<span><span class="co">#&gt;   `D:\Methods\R\myR_Packages\myCompletePks\dissmapr\inst\extdata\rsa.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 16.45802 ymin: -34.83514 xmax: 32.89125 ymax: -22.12661</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span></span>
<span><span class="co"># Define your resolution and create mask to use later</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># 0.5 degrees is roughly 55km</span></span>
<span></span>
<span><span class="co"># Convert to a terra vector</span></span>
<span><span class="va">rsa_vect</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">rsa</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an empty raster over RSA at your desired resolution</span></span>
<span><span class="va">grid</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">rsa_vect</span>, resolution <span class="op">=</span> <span class="va">res</span>, crs <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">rsa_vect</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span>   <span class="co"># fill with dummy values</span></span>
<span></span>
<span><span class="co"># Mask everything outside the RSA boundary</span></span>
<span><span class="va">grid_masked</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">grid</span>, <span class="va">rsa_vect</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="id_4-get-species-occurrence-records-using-get_occurrence_data">4. Get species occurrence records using <code>get_occurrence_data</code>
<a class="anchor" aria-label="anchor" href="#id_4-get-species-occurrence-records-using-get_occurrence_data"></a>
</h3>
<p>This section focuses on automating the retrieval and pre-processing of biodiversity occurrence data from various sources, including:</p>
<ol style="list-style-type: decimal">
<li>local <code>databases</code>.csv` files,</li>
<li>URLs or <code>.zip</code> files from the Global Biodiversity Information Facility (GBIF), and</li>
<li>species occurrence cubes from B3 (specification) [<em>work in progress</em>].</li>
</ol>
<p>The function assembles data on species distributions across specified taxonomic groups and regions, producing presence-absence or abundance matrices that quantify species co-occurrence within locations.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bfly_data</span> <span class="op">=</span> <span class="fu"><a href="reference/get_occurrence_data.html">get_occurrence_data</a></span><span class="op">(</span></span>
<span>  data        <span class="op">=</span> <span class="st">'inst/extdata/gbif_butterflies.csv'</span>,</span>
<span>  source_type <span class="op">=</span> <span class="st">'local_csv'</span>,</span>
<span>  sep         <span class="op">=</span> <span class="st">'\t'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bfly_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 81825    52</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bfly_data</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      gbifID                           datasetKey occurrenceID  kingdom     phylum   class</span></span>
<span><span class="co">#&gt; 1 923051749 6ac3f774-d9fb-4796-b3e9-92bf6c81c084              Animalia Arthropoda Insecta</span></span>
<span><span class="co">#&gt; 2 922985630 6ac3f774-d9fb-4796-b3e9-92bf6c81c084              Animalia Arthropoda Insecta</span></span>
<span><span class="co">#&gt; 3 922619348 6ac3f774-d9fb-4796-b3e9-92bf6c81c084              Animalia Arthropoda Insecta</span></span>
<span><span class="co">#&gt; 4 922426210 6ac3f774-d9fb-4796-b3e9-92bf6c81c084              Animalia Arthropoda Insecta</span></span>
<span><span class="co">#&gt; 5 921650584 6ac3f774-d9fb-4796-b3e9-92bf6c81c084              Animalia Arthropoda Insecta</span></span>
<span><span class="co">#&gt;         order        family     genus            species infraspecificEpithet  taxonRank</span></span>
<span><span class="co">#&gt; 1 Lepidoptera      Pieridae    Pieris   Pieris brassicae                         SPECIES</span></span>
<span><span class="co">#&gt; 2 Lepidoptera      Pieridae    Pieris   Pieris brassicae                         SPECIES</span></span>
<span><span class="co">#&gt; 3 Lepidoptera  Papilionidae   Papilio  Papilio demodocus                         SPECIES</span></span>
<span><span class="co">#&gt; 4 Lepidoptera      Pieridae Mylothris Mylothris agathina             agathina SUBSPECIES</span></span>
<span><span class="co">#&gt; 5 Lepidoptera Lasiocampidae  Eutricha  Eutricha capensis                         SPECIES</span></span>
<span><span class="co">#&gt;                       scientificName             verbatimScientificName</span></span>
<span><span class="co">#&gt; 1  Pieris brassicae (Linnaeus, 1758)                   Pieris brassicae</span></span>
<span><span class="co">#&gt; 2  Pieris brassicae (Linnaeus, 1758)                   Pieris brassicae</span></span>
<span><span class="co">#&gt; 3      Papilio demodocus Esper, 1798 Papilio demodocus subsp. demodocus</span></span>
<span><span class="co">#&gt; 4        Mylothris agathina agathina Mylothris agathina subsp. agathina</span></span>
<span><span class="co">#&gt; 5 Eutricha capensis (Linnaeus, 1767)                  Eutricha capensis</span></span>
<span><span class="co">#&gt;   verbatimScientificNameAuthorship countryCode                                          locality</span></span>
<span><span class="co">#&gt; 1                               NA          ZA                                          Hermanus</span></span>
<span><span class="co">#&gt; 2                               NA          ZA                                   Polkadraai Road</span></span>
<span><span class="co">#&gt; 3                               NA          ZA                                       Signal Hill</span></span>
<span><span class="co">#&gt; 4                               NA          ZA                                          Hermanus</span></span>
<span><span class="co">#&gt; 5                               NA          ZA Cape of Good Hope / Cape Point Area, South Africa</span></span>
<span><span class="co">#&gt;   stateProvince occurrenceStatus individualCount                     publishingOrgKey         y</span></span>
<span><span class="co">#&gt; 1                        PRESENT              NA bb646dff-a905-4403-a49b-6d378c2cf0d9 -34.42086</span></span>
<span><span class="co">#&gt; 2                        PRESENT              NA bb646dff-a905-4403-a49b-6d378c2cf0d9 -33.96044</span></span>
<span><span class="co">#&gt; 3                        PRESENT              NA bb646dff-a905-4403-a49b-6d378c2cf0d9 -33.91651</span></span>
<span><span class="co">#&gt; 4                        PRESENT              NA bb646dff-a905-4403-a49b-6d378c2cf0d9 -34.42086</span></span>
<span><span class="co">#&gt; 5                        PRESENT              NA bb646dff-a905-4403-a49b-6d378c2cf0d9 -34.35024</span></span>
<span><span class="co">#&gt;          x coordinateUncertaintyInMeters coordinatePrecision elevation elevationAccuracy depth</span></span>
<span><span class="co">#&gt; 1 19.24410                           250                  NA        NA                NA    NA</span></span>
<span><span class="co">#&gt; 2 18.75564                           250                  NA        NA                NA    NA</span></span>
<span><span class="co">#&gt; 3 18.40321                           250                  NA        NA                NA    NA</span></span>
<span><span class="co">#&gt; 4 19.24410                           250                  NA        NA                NA    NA</span></span>
<span><span class="co">#&gt; 5 18.47488                           250                  NA        NA                NA    NA</span></span>
<span><span class="co">#&gt;   depthAccuracy        eventDate day month year taxonKey speciesKey     basisOfRecord</span></span>
<span><span class="co">#&gt; 1            NA 2012-10-13T00:00  13    10 2012  1920506    1920506 HUMAN_OBSERVATION</span></span>
<span><span class="co">#&gt; 2            NA 2012-11-01T00:00   1    11 2012  1920506    1920506 HUMAN_OBSERVATION</span></span>
<span><span class="co">#&gt; 3            NA 2012-10-31T00:00  31    10 2012  1938125    1938125 HUMAN_OBSERVATION</span></span>
<span><span class="co">#&gt; 4            NA 2012-10-13T00:00  13    10 2012 11374894    5137998 HUMAN_OBSERVATION</span></span>
<span><span class="co">#&gt; 5            NA 2012-10-30T00:00  30    10 2012  6113873    6113873 HUMAN_OBSERVATION</span></span>
<span><span class="co">#&gt;   institutionCode collectionCode catalogNumber recordNumber identifiedBy dateIdentified   license</span></span>
<span><span class="co">#&gt; 1     naturgucker    naturgucker    -190723441                                          CC_BY_4_0</span></span>
<span><span class="co">#&gt; 2     naturgucker    naturgucker    2051102952                                          CC_BY_4_0</span></span>
<span><span class="co">#&gt; 3     naturgucker    naturgucker    1565945073                                          CC_BY_4_0</span></span>
<span><span class="co">#&gt; 4     naturgucker    naturgucker   -1879976251                                          CC_BY_4_0</span></span>
<span><span class="co">#&gt; 5     naturgucker    naturgucker   -1022055456                                          CC_BY_4_0</span></span>
<span><span class="co">#&gt;   rightsHolder recordedBy typeStatus establishmentMeans          lastInterpreted  mediaType</span></span>
<span><span class="co">#&gt; 1               591374253         NA                 NA 2024-03-15T23:20:20.346Z           </span></span>
<span><span class="co">#&gt; 2               591374253         NA                 NA 2024-03-15T23:22:38.206Z           </span></span>
<span><span class="co">#&gt; 3               591374253         NA                 NA 2024-03-15T23:26:59.721Z           </span></span>
<span><span class="co">#&gt; 4               591374253         NA                 NA 2024-03-15T23:23:55.839Z StillImage</span></span>
<span><span class="co">#&gt; 5               591374253         NA                 NA 2024-03-15T23:22:38.836Z StillImage</span></span>
<span><span class="co">#&gt;                                                                                                                              issue</span></span>
<span><span class="co">#&gt; 1                        COORDINATE_ROUNDED;GEODETIC_DATUM_ASSUMED_WGS84;CONTINENT_DERIVED_FROM_COORDINATES;MULTIMEDIA_URI_INVALID</span></span>
<span><span class="co">#&gt; 2                        COORDINATE_ROUNDED;GEODETIC_DATUM_ASSUMED_WGS84;CONTINENT_DERIVED_FROM_COORDINATES;MULTIMEDIA_URI_INVALID</span></span>
<span><span class="co">#&gt; 3 COORDINATE_ROUNDED;GEODETIC_DATUM_ASSUMED_WGS84;CONTINENT_DERIVED_FROM_COORDINATES;TAXON_MATCH_HIGHERRANK;MULTIMEDIA_URI_INVALID</span></span>
<span><span class="co">#&gt; 4                                               COORDINATE_ROUNDED;GEODETIC_DATUM_ASSUMED_WGS84;CONTINENT_DERIVED_FROM_COORDINATES</span></span>
<span><span class="co">#&gt; 5                                               COORDINATE_ROUNDED;GEODETIC_DATUM_ASSUMED_WGS84;CONTINENT_DERIVED_FROM_COORDINATES</span></span>
<span><span class="co">#&gt;   site_id pa</span></span>
<span><span class="co">#&gt; 1       1  1</span></span>
<span><span class="co">#&gt; 2       2  1</span></span>
<span><span class="co">#&gt; 3       3  1</span></span>
<span><span class="co">#&gt; 4       1  1</span></span>
<span><span class="co">#&gt; 5       4  1</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="id_5-format-data-using-format_df">5. Format data using <code>format_df</code>
<a class="anchor" aria-label="anchor" href="#id_5-format-data-using-format_df"></a>
</h3>
<p>Use <code>format_df</code> to standardise and reshape biodiversity data into long or wide formats. The function automatically identifies key columns (e.g., coordinates, species, and values), assigns missing site IDs, and reformats the data for analysis. Outputs include a cleaned dataset and species-site matrices for further processing:</p>
<p>• site_xy: Holds spatial coordinates of sampled sites.<br>
• site_sp: Site-by-species matrix for biodiversity assessments.</p>
<div class="section level4">
<h4 id="format-data-into-long-and-wide-formats">Format data into long and wide formats<a class="anchor" aria-label="anchor" href="#format-data-into-long-and-wide-formats"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bfly_result</span> <span class="op">=</span> <span class="fu"><a href="reference/format_df.html">format_df</a></span><span class="op">(</span></span>
<span>  data        <span class="op">=</span> <span class="va">bfly_data</span>,</span>
<span>  species_col <span class="op">=</span> <span class="st">'verbatimScientificName'</span>,</span>
<span>  value_col   <span class="op">=</span> <span class="st">'pa'</span>,</span>
<span>  extra_cols  <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format      <span class="op">=</span> <span class="st">'long'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: Create new objects from list items</span></span>
<span><span class="va">site_obs</span> <span class="op">=</span> <span class="va">bfly_result</span><span class="op">$</span><span class="va">site_obs</span></span>
<span><span class="va">site_spp</span> <span class="op">=</span> <span class="va">bfly_result</span><span class="op">$</span><span class="va">site_sp</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">site_obs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 79953     5</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">site_obs</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   site_id        x         y                            species value</span></span>
<span><span class="co">#&gt; 1       1 19.24410 -34.42086                   Pieris brassicae     1</span></span>
<span><span class="co">#&gt; 2       2 18.75564 -33.96044                   Pieris brassicae     1</span></span>
<span><span class="co">#&gt; 3       3 18.40321 -33.91651 Papilio demodocus subsp. demodocus     1</span></span>
<span><span class="co">#&gt; 4       1 19.24410 -34.42086 Mylothris agathina subsp. agathina     1</span></span>
<span><span class="co">#&gt; 5       4 18.47488 -34.35024                  Eutricha capensis     1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">site_spp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 56090  2871</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">site_spp</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 2,871</span></span>
<span><span class="co">#&gt;   site_id     x     y Mylothris agathina subsp.…¹ `Pieris brassicae` `Tarucus thespis` `Acraea horta`</span></span>
<span><span class="co">#&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;                       &lt;dbl&gt;              &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1       1  19.2 -34.4                           1                  1                 1              0</span></span>
<span><span class="co">#&gt; 2       2  18.8 -34.0                           0                  1                 0              0</span></span>
<span><span class="co">#&gt; 3       3  18.4 -33.9                           0                  0                 0              2</span></span>
<span><span class="co">#&gt; 4       4  18.5 -34.4                           0                  0                 0              0</span></span>
<span><span class="co">#&gt; 5       5  25.7 -33.6                           0                  0                 0              0</span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​`Mylothris agathina subsp. agathina`</span></span>
<span><span class="co">#&gt; # ℹ 2,864 more variables: `Danaus chrysippus` &lt;dbl&gt;, `Papilio demodocus subsp. demodocus` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Eutricha capensis` &lt;dbl&gt;, `Mesocelis monticola` &lt;dbl&gt;, `Vanessa cardui` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Cuneisigna obstans` &lt;dbl&gt;, `Dixeia charina subsp. charina` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Drepanogynis bifasciata` &lt;dbl&gt;, `Drepanogynis cambogiaria` &lt;dbl&gt;, `Chiasmia observata` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Catacroptera cloanthe` &lt;dbl&gt;, `Precis octavia` &lt;dbl&gt;, `Acraea rabbaiae` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Amauris ochlea` &lt;dbl&gt;, `Amauris ochlea ochlea` &lt;dbl&gt;, `Appias sabina phoebe` &lt;dbl&gt;, …</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="get-parameters-to-use-later">Get parameters to use later<a class="anchor" aria-label="anchor" href="#get-parameters-to-use-later"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get parameters from processed data</span></span>
<span><span class="co"># Number of species columns</span></span>
<span><span class="op">(</span><span class="va">n_sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">site_spp</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2868</span></span>
<span></span>
<span><span class="co"># Species names</span></span>
<span><span class="va">sp_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">site_spp</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp_cols</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="id_6-summarise-records-by-grid-centroid-using-generate_grid">6. Summarise records by grid centroid using <code>generate_grid</code>
<a class="anchor" aria-label="anchor" href="#id_6-summarise-records-by-grid-centroid-using-generate_grid"></a>
</h3>
<p>Use <code>generate_grid</code> to divide the study area, derived from the geographic extent of the occurrence data above, into grids of user-defined resolution, creating a spatial grid over a specified geographic extent. It assigns unique grid IDs to points and summarizes selected data columns within each grid cell. The function outputs a raster grid, grid polygons for visualization, and a data frame summarizing the contents of each grid cell, including totals and centroids. It is particularly useful for aggregating spatial data, such as biodiversity observations, into predefined spatial units for further analysis.</p>
<div class="section level4">
<h4 id="assign-records-to-a-grid-at-a-set-resolution-eg-05">Assign records to a grid at a set resolution (e.g. 0.5°)<a class="anchor" aria-label="anchor" href="#assign-records-to-a-grid-at-a-set-resolution-eg-05"></a>
</h4>
<p>Aggregate species records into equal-area grid cells to enable spatially standardized biodiversity analyses.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid_list</span> <span class="op">=</span> <span class="fu"><a href="reference/generate_grid.html">generate_grid</a></span><span class="op">(</span></span>
<span>  data       <span class="op">=</span> <span class="va">site_spp</span>,</span>
<span>  x_col      <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  y_col      <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  grid_size  <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sum_col_range <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">site_spp</span><span class="op">)</span>,</span>
<span>  crs_epsg   <span class="op">=</span> <span class="fl">4326</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: Create new objects from list items</span></span>
<span><span class="va">aoi_grid</span> <span class="op">=</span> <span class="va">grid_list</span><span class="op">$</span><span class="va">grid_sf</span></span>
<span><span class="va">grid_spp</span> <span class="op">=</span> <span class="va">grid_list</span><span class="op">$</span><span class="va">block_sp</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">aoi_grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1110    8</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">aoi_grid</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 5 features and 6 fields</span></span>
<span><span class="co">#&gt; Active geometry column: geometry</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 15.5 ymin: -36 xmax: 18 ymax: -35.5</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;   centroid_lon centroid_lat grid_id  mapsheet obs_sum spp_rich                       geometry</span></span>
<span><span class="co">#&gt; 1        15.75       -35.75       1 E015S36BB      NA       NA POLYGON ((15.5 -36, 16 -36,...</span></span>
<span><span class="co">#&gt; 2        16.25       -35.75       2 E016S36BB      NA       NA POLYGON ((16 -36, 16.5 -36,...</span></span>
<span><span class="co">#&gt; 3        16.75       -35.75       3 E016S36BB      NA       NA POLYGON ((16.5 -36, 17 -36,...</span></span>
<span><span class="co">#&gt; 4        17.25       -35.75       4 E017S36BB      NA       NA POLYGON ((17 -36, 17.5 -36,...</span></span>
<span><span class="co">#&gt; 5        17.75       -35.75       5 E017S36BB      NA       NA POLYGON ((17.5 -36, 18 -36,...</span></span>
<span><span class="co">#&gt;               centroid</span></span>
<span><span class="co">#&gt; 1 POINT (15.75 -35.75)</span></span>
<span><span class="co">#&gt; 2 POINT (16.25 -35.75)</span></span>
<span><span class="co">#&gt; 3 POINT (16.75 -35.75)</span></span>
<span><span class="co">#&gt; 4 POINT (17.25 -35.75)</span></span>
<span><span class="co">#&gt; 5 POINT (17.75 -35.75)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">grid_spp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  415 2874</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grid_spp</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      grid_id centroid_lon centroid_lat mapsheet obs_sum spp_rich Mylothris agathina subsp. agathina</span></span>
<span><span class="co">#&gt;      Pieris brassicae Tarucus thespis Acraea horta Danaus chrysippus</span></span>
<span><span class="co">#&gt;      Papilio demodocus subsp. demodocus Eutricha capensis Mesocelis monticola Vanessa cardui</span></span>
<span><span class="co">#&gt;      Cuneisigna obstans Dixeia charina subsp. charina Drepanogynis bifasciata</span></span>
<span><span class="co">#&gt;      Drepanogynis cambogiaria Chiasmia observata Catacroptera cloanthe Precis octavia</span></span>
<span><span class="co">#&gt;      Acraea rabbaiae Amauris ochlea Amauris ochlea ochlea Appias sabina phoebe</span></span>
<span><span class="co">#&gt;      Belenois gidica abyssinica Bicyclus safitza safitza Colotis euippe Ernsta dromus</span></span>
<span><span class="co">#&gt;      Eurytela hiarbas angustata Graphium antheus Graphium leonidas leonidas Hypolimnas anthedon</span></span>
<span><span class="co">#&gt;      Hypolycaena philippus Junonia oenone oenone Leptotes pirithous Papilio nireus</span></span>
<span><span class="co">#&gt;      Papilio nireus lyaeus Stephenia natalica Telchinia encedon encedon Eronia cleodora</span></span>
<span><span class="co">#&gt;      Teracolus eris eris Hippotion eson Colotis annae annae Junonia hierta cebrene Junonia hierta</span></span>
<span><span class="co">#&gt;      Hamanumida daedalus Papilio demodocus Aloeides pierus Acanthovalva focularia Achyra nudalis</span></span>
<span><span class="co">#&gt;      Acontia accola Adicocrita koranata Adisura aerugo Agrius convolvuli Agrotis crassilinea</span></span>
<span><span class="co">#&gt;      Agrotis denticulosa Antigastra catalaunalis Antiophlebia bracteata Argyrophora stramineata</span></span>
<span><span class="co">#&gt;      Argyrophora trofonia Axiodes asteiochlora Axiodes ectoglauca Axiodes figurata</span></span>
<span><span class="co">#&gt;      Axiodes interscripta Axiodes intricata Axiodes leucoloma Axiodes rufigrisea</span></span>
<span><span class="co">#&gt;      Belenois aurota aurota Blenina squamifera Bocchoris inspersalis Bombycomorpha bifascia</span></span>
<span><span class="co">#&gt;      Bombycopsis tephrobaphes Brephidium metophis Cardepia definiens Catopsilia florella</span></span>
<span><span class="co">#&gt;      Cerocala vermiculosa Ceromitia wahlbergi Chiasmia brongusaria Chiasmia inaequilinea</span></span>
<span><span class="co">#&gt;      Chlorerythra rubriplaga Chrysoritis lysander Chrysoritis plutus Colotis euippe omphale</span></span>
<span><span class="co">#&gt;      Colotis evenina Comibaena leucospilata Cornutiplusia circumflexa Cymaroa grisea</span></span>
<span><span class="co">#&gt;      Derriodes cnephaeogramma Derriodes miltophyris Diaphania indica Diaphone eumela</span></span>
<span><span class="co">#&gt;      Dicranuropsis vilis Diota rostrata Drepanogynis insolens Drepanogynis mixtaria</span></span>
<span><span class="co">#&gt;      Drepanogynis pero Drepanogynis sinuata Earias biplaga Earias insulana Ernsta sataspes</span></span>
<span><span class="co">#&gt;      Eublemma admota Eublemma caffrorum Euchromius ocellea Eucrostes rufociliaria Eurranthis acuta</span></span>
<span><span class="co">#&gt;      Gorgopis pholidota Grammodes stolida Helicoverpa armigera Heliothis scutuligera</span></span>
<span><span class="co">#&gt;      Hemixesma anthocrenias Hydriris ornatalis Hyles livornica Isturgia deerraria</span></span>
<span><span class="co">#&gt;      Klugeana philoxalis Lacipa picta Latoia latistriga Leptomyrina lara Loryma basalis</span></span>
<span><span class="co">#&gt;      Lorymodes digonialis Menophra serrataria Mentaxya ignicollis Metisella malgacha malgacha</span></span>
<span><span class="co">#&gt;      Microloxia ruficornis Nomophila africana Omphalucha maturnaria Ophiusa dianaris</span></span>
<span><span class="co">#&gt;      Ophiusa selenaris Ophiusa tirhaca Oraesia triobliqua Oraidium barberae Pagyda salvalis</span></span>
<span><span class="co">#&gt;      Paralacydes vocula Parapoynx fluctuosalis Phyllalia patens Phyllalia thunbergii</span></span>
<span><span class="co">#&gt;      Plutella xylostella Pontia helice helice Prasinocyma panchlora Pseudomaenas alcidata</span></span>
<span><span class="co">#&gt;      Pseudomaenas honiballi Pseudomaenas intricata Pyralis farinalis Rhabdosia vaninia</span></span>
<span><span class="co">#&gt;      Rhodometra participata Rhodometra sacraria Scotopteryx deversa Sicyodes cambogiaria</span></span>
<span><span class="co">#&gt;      Sicyodes olivescens Sommeria ostentata Sphingomorpha chlorea Spialia spio Spodoptera exigua</span></span>
<span><span class="co">#&gt;      Spodoptera littoralis Spoladea recurvalis Streblote uniforme Tarsocera Tearosoma aspersum</span></span>
<span><span class="co">#&gt;      Tegiapa virescens Temnora pylas Terastia africana Theretra capensis Thyretes hippotes</span></span>
<span><span class="co">#&gt;      Thysanoplusia orichalcea Traminda ocellata Tytroca metaxantha Udea ferrugalis</span></span>
<span><span class="co">#&gt;      Utetheisa pulchella Vegetia grimmia Victoria albipicta Zizeeria knysna Zizeeria knysna knysna</span></span>
<span><span class="co">#&gt;      Ercheia subsignata Tildia anemosa Leucotrachea melanodonta Agrotis ipsilon Agrotis segetum</span></span>
<span><span class="co">#&gt;      Araea indecora Ariathisa abyssinia Asota speciosa Aventiola truncataria Bracharoa dregei</span></span>
<span><span class="co">#&gt;      Brevipecten cornuta Brunia vicaria Calesia xanthognatha Callicercops triceros</span></span>
<span><span class="co">#&gt;      Chiasmia semitecta Chloroclystis muscosa Cirrhochrista grabczewskyi Cleora flavivenata</span></span>
<span><span class="co">#&gt;      Comostolopsis capensis Comostolopsis germana Corgatha producta Crambus sparsellus</span></span>
<span><span class="co">#&gt;      Crocidosema plebejana Ctenoplusia limbirena Desmeocraera nugatrix Diasemia disjectalis</span></span>
<span><span class="co">#&gt;      Diasemia monostigma Duponchelia lanceolalis Dysgonia torrida Eublemma apicimacula</span></span>
<span><span class="co">#&gt;      Eudasychira proleprota Eupithecia inconclusaria Gaana africana</span></span>
<span><span class="co">#&gt;      Gonanticlea meridionata meridionata Hamartia clarissa Holocerina smilax Hypena commixtalis</span></span>
<span><span class="co">#&gt;      Hypena senialis Hypenodes nigricolora Hypercodia wheeleri Hypomecis gonophora</span></span>
<span><span class="co">#&gt;      Hypsopygia nostralis Iambia melanochlora Laelia fusca Lygephila salax Meganola nigristriga</span></span>
<span><span class="co">#&gt;      Mentaxya muscosa Metachrostis anticalis Metisella metis metis Mythimna languida Nephele comma</span></span>
<span><span class="co">#&gt;      Neuranethes spodopterodes Nodaria nodosalis Nola tineoides Nomophila noctuella</span></span>
<span><span class="co">#&gt;      Notarcha quaternalis Obolcola decisa Odontosida pusillus Omphalucha crenulata</span></span>
<span><span class="co">#&gt;      Orthonama obstipata Ovios capensis Ozarba accincta Palpita vitrealis Panagropsis equitaria</span></span>
<span><span class="co">#&gt;      Pandesma robusta Piercia prasinaria Pontia helice Rhodogastria amasis Sarmatia interitalis</span></span>
<span><span class="co">#&gt;      Scopula hectata Simplicia extinctalis Sommeria culta Sommeria spilosoma Spodoptera cilium</span></span>
<span><span class="co">#&gt;      Temnora pseudopylas Thysanoplusia angulum Thysanoplusia sestertia Trachypteryx magella</span></span>
<span><span class="co">#&gt;      Trymalitis scalifera Xanthorhoe exorista Xanthorhoe poseata Xylopteryx arcuata</span></span>
<span><span class="co">#&gt;      Xylopteryx prasinaria Xylopteryx protearia Zebeeba meceneronis Zellereccopsis caffreana</span></span>
<span><span class="co">#&gt;      Zitha laminalis Zitha zonalis Macrocossus toluminus Amyna axis Cometaster pyrula</span></span>
<span><span class="co">#&gt;      Cryphia fulvifusa Honeyia clearchus Mixocera frustratoria Palasea albimacula</span></span>
<span><span class="co">#&gt;      Pardomima callixantha Phalera lydenburgi Rufoclanis numosae Stenochora lancinalis</span></span>
<span><span class="co">#&gt;      Stenoglene obtusa Xanthodes albago Coelonia fulvinotata Hypopyra capensis Acontia discoidea</span></span>
<span><span class="co">#&gt;      Acontia imitatrix Acontia trimaculata Afroclanis calcarea Amerila lupia Amyops ingens</span></span>
<span><span class="co">#&gt;      Anomis auragoides Archaeopilocornus lucidus Calesia zambesita Crocidolomia pavonana</span></span>
<span><span class="co">#&gt;      Desmeocraera basalis Epitrabala argenteoguttata Ethioterpia lichenea Ethioterpia marmorata</span></span>
<span><span class="co">#&gt;      Eudocima materna Eutelia polychorda Fentonina exacta Gynanisa maja Heliothis galatheae</span></span>
<span><span class="co">#&gt;      Hemerophanes libyra libyra Mazuca amoena Metajana marshalli Omphax plantaria</span></span>
<span><span class="co">#&gt;      Oneiliana multifera Ophiusa mejanesi Pericyma atrifusa Phoenicocampa rubrifasciata</span></span>
<span><span class="co">#&gt;      Pioneabathra olesialis Polydesma umbricola Radara subcupralis Rufoclanis jansei</span></span>
<span><span class="co">#&gt;      Sena prompta plusioides Theretra monteironis Xenimpia erosa Philotherma rennei</span></span>
<span><span class="co">#&gt;      Epichoristodes acerbella Isturgia spissata Striphnopteryx edulis Euproctis haemodetes</span></span>
<span><span class="co">#&gt;      Achaea praestans Acleros mackenii Acontia guttifera Acontia trychaenoides Acontia wallengreni</span></span>
<span><span class="co">#&gt;      Aethalopteryx squameus Agoma trimenii Aiteta veluta Amerila bauri Analyta calligrammalis</span></span>
<span><span class="co">#&gt;      Anoba atripuncta Anoba plumipes Aurivillius fuscus Autocharis jacobsalis Baniana culminifera</span></span>
<span><span class="co">#&gt;      Belenois gidica Beralade perobliqua Bicyclus anynana anynana Bostra xanthorhodalis</span></span>
<span><span class="co">#&gt;      Brevipecten legraini Bunaea alcinoe Callopistria latreillei Celidomphax rubrimaculata</span></span>
<span><span class="co">#&gt;      Cetola pulchra Charaxes candiope Chrysopoloma restricta Chrysopoloma varia Coenina poecilaria</span></span>
<span><span class="co">#&gt;      Coenyropsis natalii Colbusa euclidica Colotis vesta Colotis vesta argillaceus</span></span>
<span><span class="co">#&gt;      Corgatha porphyrana Craspia marshalli Cyligramma latona Dasychira extatura Deltoptera iphia</span></span>
<span><span class="co">#&gt;      Dysallacta negatalis Enargeiosia elegans Euexia percnopus Eutelia callichroma Fentonina punctum</span></span>
<span><span class="co">#&gt;      Goodia kuntzei Grammodes congenita Hemerophanes libyra Hemiolaus caeculus</span></span>
<span><span class="co">#&gt;      Heterorachis roseifimbria Hippotion roseipennis Homoeomeria flavicapilla Honeyania plumbosa</span></span>
<span><span class="co">#&gt;      Hypopyra africana Latoia intermissa Magusa versicolora Magusa viettei Marathyssa albidisca</span></span>
<span><span class="co">#&gt;      Maurilia arcuata Melanitis leda Micraphe lateritia Neopolyptychus compar Orbamia octomaculata</span></span>
<span><span class="co">#&gt;      Ozarba hemiochra Parafodina pentagonalis Pardomima distortana Phostria bistigmalis</span></span>
<span><span class="co">#&gt;      Plecoptera sarcistis Plecopterodes moderata Protarache melaphora Psara atritermina</span></span>
<span><span class="co">#&gt;      Pseudonacaduba sichela Rhesala moestalis Sameodes cancellalis Sarangesa ruona</span></span>
<span><span class="co">#&gt;      Schalidomitra ambages Sphalerosticha oblunata Terastia margaritis Thyretes caffra</span></span>
<span><span class="co">#&gt;      Timora disticta Trachypteryx rhodoxantha Uresiphita gilvata Usta terpsichore Zintha hintza</span></span>
<span><span class="co">#&gt;      Telchinia cabira Acrasia crinita Acronicta transvalica Argyrophora arcualis Chabulina astomalis</span></span>
<span><span class="co">#&gt;      Chiasmia turbulentata Dasychira octophora Dichroma equestralis Haplolabida inaequata</span></span>
<span><span class="co">#&gt;      Isocrita protophanes Prionapteryx splendida Pseudophragmatobia perpunctata Achaea catella</span></span>
<span><span class="co">#&gt;      Rhadinomphax trimeni Terias brigitta brigitta Anthemoctena textilis Cacyreus fracta fracta</span></span>
<span><span class="co">#&gt;      Phasis thero thero Spialia mafa Iolaus mimosae rhodosense Leptosia alcesta Deudorix antalus</span></span>
<span><span class="co">#&gt;      Papilio demodocus demodocus Poloma angulata Pteredoa monosticta Antigastra morysalis</span></span>
<span><span class="co">#&gt;      Charaxes brutus natalensis Chlorissa albistrigulata Danaus chrysippus orientis</span></span>
<span><span class="co">#&gt;      Polymona rufifemur Streblote cristata Acrapex aenigma Afrasura rivulosa Allochrostes biornata</span></span>
<span><span class="co">#&gt;      Anadiasa affinis Cecidothyris pexa Conchylia pactolaria Diasemiopsis ramburialis</span></span>
<span><span class="co">#&gt;      Dragmatucha proaula Halseyia bisecta Haplopacha cinerea Hypocala rostrata</span></span>
<span><span class="co">#&gt;      Lhommeia biskraria illiturata Mixocera albistrigata Neogavara imitans Odites natalensis</span></span>
<span><span class="co">#&gt;      Ozarba nigroviridis Piletocera flavalis Trichopisthia monteiroi Xanthomera leucoglene</span></span>
<span><span class="co">#&gt;      Axiodes insciata Terias desjardinsii Zizula hylax hylax Eulycia accentuata Euproctis crocata</span></span>
<span><span class="co">#&gt;      Macroglossum trochilus Piercia bryophilaria Protosteira spectabilis Siccia caffra</span></span>
<span><span class="co">#&gt;      Achroia grisella Cyana marshalli Iambia jansei Laelia clarki Lamoria imbella</span></span>
<span><span class="co">#&gt;      Pseudaphelia apollinaris Tycomarptes inferior Terias desjardinsii regularis Durbania limbata</span></span>
<span><span class="co">#&gt;      Capys alpheus Abantis paradisea Acantholipes trimeni Achaea echo Achaea finita Achaea lienardi</span></span>
<span><span class="co">#&gt;      Achaea trapezoides Acronicta silvicola Agathodes musivalis Agrotera citrina Amata simplex</span></span>
<span><span class="co">#&gt;      Amauris albimaculata albimaculata Amerila bubo Amerila magnifica Amerila phaedra</span></span>
<span><span class="co">#&gt;      Amerila vitrea vitrea Anaphe reticulata Anedhella interrupta Anoba sinuata Anomis flava</span></span>
<span><span class="co">#&gt;      Anomis leona Anthene amarah Anthene amarah amarah Anthene livida livida Aroa discalis</span></span>
<span><span class="co">#&gt;      Arsina vausema Ascotis reciprocaria Azanus jesous Azygophleps inclusa Basiothia medea</span></span>
<span><span class="co">#&gt;      Belenois creona severina Belenois thysa thysa Borbo borbonica borbonica Borbo detecta</span></span>
<span><span class="co">#&gt;      Borbo fatuellus fatuellus Borbo lugens Brachmia septella Bradina admixtalis</span></span>
<span><span class="co">#&gt;      Byblia anvatara acheloia Cacyreus marshalli Cadarena pudoraria Callopistria maillardi</span></span>
<span><span class="co">#&gt;      Callopistria yerburii Cephonodes hylas virescens Cerynea thermesialis Ceryx pterophorina</span></span>
<span><span class="co">#&gt;      Charaxes castor flavifasciatus Charaxes ethalion ethalion Charaxes varanes varanes</span></span>
<span><span class="co">#&gt;      Chiasmia deceptrix Chiasmia rectistriaria Chiasmia subcurvaria Chloroclystis muscosa tumefacta</span></span>
<span><span class="co">#&gt;      Chrysodeixis chalcites Cirina forda Cleora munda Cleora tulbaghata Coeliades pisistratus</span></span>
<span><span class="co">#&gt;      Colocleora divisaria Colotis antevippe gavisa Comostolopsis stillata Conolophia aemula</span></span>
<span><span class="co">#&gt;      Corgatha latifera Cragia distigmata Cyclophora unocula Cyligramma fluctuosa Disticta atava</span></span>
<span><span class="co">#&gt;      Duponchelia fovealis Dysgonia angularis Eccopsis incultana Egnasia vicaria Egybolis vaillantina</span></span>
<span><span class="co">#&gt;      Epiphora mythimnia Erebus walkeri Ericeia congressa Eublemma cochylioides Eublemma costimacula</span></span>
<span><span class="co">#&gt;      Eublemma illimitata Euchloron megaera Euchromia amoena Eucraera salammbo Eudocima afrikana</span></span>
<span><span class="co">#&gt;      Euplexia augens Euproctis aethiopica Euproctis hardenbergia Euproctis punctifera</span></span>
<span><span class="co">#&gt;      Eurrhyparodes tricoloralis Eurytela dryope angulata Eutelia amatrix Eutelia bowkeri</span></span>
<span><span class="co">#&gt;      Filodes costivitralis Glyphodes bitriangulalis Glyphodes stolalis Gonimbrasia zambesina</span></span>
<span><span class="co">#&gt;      Gracilodes caffra Gracilodes nysa Halseyia rectifascia Haritalodes derogata</span></span>
<span><span class="co">#&gt;      Herpetogramma mutualis Heterorachis devocata devocata Hippotion celerio Hodebertia testalis</span></span>
<span><span class="co">#&gt;      Hymenia perspectalis Hypena laceratalis Hypena lividalis Hypena varialis</span></span>
<span><span class="co">#&gt;      Hypolimnas anthedon wahlbergi Hypolimnas misippus Hypolycaena philippus philippus</span></span>
<span><span class="co">#&gt;      Iolaus silarus silarus Jana eurymas Laelia albimaculata Laelia extorta Laelia lunensis</span></span>
<span><span class="co">#&gt;      Lampides boeticus Latoia vivida Leipoxais peraffinis Leptosia alcesta inalcesta Libythea laius</span></span>
<span><span class="co">#&gt;      Lophostethus dumolinii Maliattha subblandula Marasmia poeyalis Marasmia trapezalis</span></span>
<span><span class="co">#&gt;      Melanitis leda leda Metallochlora grisea Mocis mayeri Mocis proverai Moltena fiara</span></span>
<span><span class="co">#&gt;      Morasa modesta Mylothris agathina agathina Naroma varipes Nausinoe geometralis</span></span>
<span><span class="co">#&gt;      Nephele accentifera Nephele argentifera Neptis saclava marpessa Notarcha muscerdalis</span></span>
<span><span class="co">#&gt;      Nyctemera apicalis Oraesia provocans Orphanostigma haemorrhoidalis Palpita metallata</span></span>
<span><span class="co">#&gt;      Papilio dardanus cenea Parapluda invitabilis Parnara monasi Pelopidas Pelopidas thrax</span></span>
<span><span class="co">#&gt;      Phalanta phalantha aethiopica Philotherma rosa Phodoryctis caerulea Phyllocnistis citrella</span></span>
<span><span class="co">#&gt;      Phytometra subflavalis africana Plecoptera annexa Plecoptera punctilineata Plusiodonta commoda</span></span>
<span><span class="co">#&gt;      Polyura zoolina Prasinocyma vermicularia Prophantis smaragdina Protogoniomorpha nebulosa</span></span>
<span><span class="co">#&gt;      Protogoniomorpha parhassus Pselaphelia flavivitta Pseudacraea lucretia tarquinea</span></span>
<span><span class="co">#&gt;      Pseudonacaduba sichela sichela Rhenea mediata Rhodopteriana rhodoptera Rhypopteryx rhodea</span></span>
<span><span class="co">#&gt;      Rubraea petraea Scopula lactaria Serrodes korana Sevenia boisduvali boisduvali</span></span>
<span><span class="co">#&gt;      Sevenia natalensis Sommeria aganais Spodoptera triturata Stephenia oncaea</span></span>
<span><span class="co">#&gt;      Stoermeriana singulare Streblote jansei Syllepte purpurascens Synclera traducalis</span></span>
<span><span class="co">#&gt;      Syngamia latimarginalis Tagiades flesus Tagoropsis flavinata Taviodes subjecta</span></span>
<span><span class="co">#&gt;      Telchinia esebria Temnora murina Terias hecabe solifera Thalassodes quadraria Tildia acara</span></span>
<span><span class="co">#&gt;      Traminda obversata Traminda vividaria Tumicla sagenaria Ulotrichopus variegata</span></span>
<span><span class="co">#&gt;      Viettessa margaritalis Yponomeuta strigillatus Zamarada plana denticincta Zizina otis</span></span>
<span><span class="co">#&gt;      Zizina otis antanossa Zizula hylax Zophopetes dysmephila Acrasia punctillata</span></span>
<span><span class="co">#&gt;      Bostra dipectinialis Brachylia terebroides Conicofrontia sesamoides Coryphodema tristis</span></span>
<span><span class="co">#&gt;      Ectochela canina Ectochela nigrilineata Eublemma bipartita Eublemma scitula augusta</span></span>
<span><span class="co">#&gt;      Eutelostolmus pictifimbria Glaucocharis natalensis Hypotephrina confertaria Phyllalia incerta</span></span>
<span><span class="co">#&gt;      Scotopteryx nictitaria Iambiodes nyctostola Tachosa brunnescens Zekelita tinctalis</span></span>
<span><span class="co">#&gt;      Bombycomorpha pallida Anthene definita Azanus mirza Azanus moriqua Belenois aurota</span></span>
<span><span class="co">#&gt;      Belenois creona Byblia ilithyia Coenyra hebe Cupidopsis jobates jobates Dixeia pigea</span></span>
<span><span class="co">#&gt;      Ypthima asterope asterope Agrotis spinifera Alucita spicifera Axiodes dochmoleuca</span></span>
<span><span class="co">#&gt;      Bracharoa tricolor Brithysana speyeri Conchylia nitidula Hellula undalis Leucinodes laisalis</span></span>
<span><span class="co">#&gt;      Metarctia jansei Mylothris agathina Pingasa abyssiniaria Tetracme truncataria Epitoxis amazoula</span></span>
<span><span class="co">#&gt;      Amauris albimaculata Belenois thysa Bicyclus safitza Byblia anvatara Dixeia charina</span></span>
<span><span class="co">#&gt;      Dixeia spilleri Eicochrysops hippocrates Euchromia folletii Eurytela dryope Neptis goochii</span></span>
<span><span class="co">#&gt;      Papilio dardanus Telchinia encedon Terias hecabe Acantholipes circumdata</span></span>
<span><span class="co">#&gt;      Acantholipes namacensis Acanthovalva inconspicuaria Acherontia atropos Achyra coelatalis</span></span>
<span><span class="co">#&gt;      Acontia ectorrida Acontia insocia Acontiola heliastis Acontiola varia Aconzarba decissima</span></span>
<span><span class="co">#&gt;      Acraea neobule Acronicta verbenata Aedia nigrescens nigrescens Afrophyla vethi</span></span>
<span><span class="co">#&gt;      Angustalius malacellus Arbelodes albitorquata Ascotis selenaria Aspidifrontia atavistis</span></span>
<span><span class="co">#&gt;      Aspilatopsis orthobates Athetis flavipuncta Athetis leuconephra Audea zimmeri Aurotalis similis</span></span>
<span><span class="co">#&gt;      Axylia annularis Axylia ustula Baniana arvorum Basiothia schenki Biafra concinnella</span></span>
<span><span class="co">#&gt;      Birketsmithiola sanguicosta Bombycopsis punctimarginata Bracharoa quadripunctata Brithys crini</span></span>
<span><span class="co">#&gt;      Busseola fusca Cabera strigata Cactoblastis cactorum Cadra cautella Caffristis ferrogrisea</span></span>
<span><span class="co">#&gt;      Calamoschoena stictalis Caloptilia celtina Caradrina atriluna Caradrina glaucistis</span></span>
<span><span class="co">#&gt;      Chabulina onychinalis Chiasmia multistrigata multistrigata Chiasmia simplicilinea</span></span>
<span><span class="co">#&gt;      Chilo partellus Chlorissa attenuata Chloroclystis grisea Coccothera spissana</span></span>
<span><span class="co">#&gt;      Coeliades forestan forestan Colotis evenina evenina Condica capensis Conolophia conscitaria</span></span>
<span><span class="co">#&gt;      Conservula cinisigna Cortyta canescens Cosmetra tumulata Cosmia natalensis</span></span>
<span><span class="co">#&gt;      Crambus ellipticellus Crambus tenuistriga Cryphia leucomelaena Cucullia hutchinsoni</span></span>
<span><span class="co">#&gt;      Cucullia pallidistria Culladia achroellum Cyana pretoriae pretoriae Cyana rejecta</span></span>
<span><span class="co">#&gt;      Cydia pomonella Daphnis nerii Deltophora typica Deltote bryophilina Deltote varicolora</span></span>
<span><span class="co">#&gt;      Diaphone mossambicensis Dolicharthria paediusalis Droceta cedrota Earias cupreoviridis</span></span>
<span><span class="co">#&gt;      Ectomyelois ceratoniae Elophila obliteralis Endrosis sarcitrella Epichoristodes dorsiplagana</span></span>
<span><span class="co">#&gt;      Epicrocis laticostella Episindris albimaculalis Ethiopica cupricolor Ethmia anikini</span></span>
<span><span class="co">#&gt;      Ethmia coscineutis Ethmia sabiella Etiella zinckenella Eublemma angustizona Eublemma baccatrix</span></span>
<span><span class="co">#&gt;      Eublemma ceresensis Eublemma costimacula plagiopera Eublemma daphoena Eublemma delicata</span></span>
<span><span class="co">#&gt;      Eublemma ecthaemata Eublemma gayneri Eublemma hemichiasma Eublemma juergenschmidli</span></span>
<span><span class="co">#&gt;      Eublemma mesophaea Eublemma nigrivitta Eublemma ornatula Eublemma pennula Eublemma scitula</span></span>
<span><span class="co">#&gt;      Euchromius discopis Euchromius nigrobasalis Euclasta warreni Eudalaca ammon Eumeta hardenbergi</span></span>
<span><span class="co">#&gt;      Euproctis bicolor Eutelia adulatrix Eutelia discitriga Evergestis forficalis</span></span>
<span><span class="co">#&gt;      Exophyla multistriata Faveria dionysia Galleria mellonella Glyphodella flavibrunnea</span></span>
<span><span class="co">#&gt;      Glyphodes bicolor Gorgopis libania Hadena bulgeri Heliocheilus stigmatia Heortia plumbatalis</span></span>
<span><span class="co">#&gt;      Heteropalpia vetusta Heterorachis devocata Honeyania ragusana Horisme obscurata Hypanua xylina</span></span>
<span><span class="co">#&gt;      Hypargyria metalliferella Hypena simplicalis Hypena tetrasticta Ilemodes astriga</span></span>
<span><span class="co">#&gt;      Lamoria adaptella Leptomyrina henningi henningi Leucaloa eugraphica Leucinodes pseudorbonalis</span></span>
<span><span class="co">#&gt;      Logunovium scortillum Lomographa aridata Lophoptera litigiosa Lophotarsia ochroprocta</span></span>
<span><span class="co">#&gt;      Loxostege frustalis Loxostege venustalis Maliattha caffristis Melouia krooni Menophra jansei</span></span>
<span><span class="co">#&gt;      Mentaxya albifrons Metachrostis decora Metachrostis ochrographa Metachrostis snelleni</span></span>
<span><span class="co">#&gt;      Metarctia brunneipennis Microligia pseudodolosa Mimasura tripunctoides Mimoclystia explanata</span></span>
<span><span class="co">#&gt;      Mimoclystia pudicata Mythimna tacuna Naarda nigripalpis Neaxestis acutangula</span></span>
<span><span class="co">#&gt;      Neaxestis piperitella Neocucullia albisignata Obolcola petronaria Opogona omoscopa</span></span>
<span><span class="co">#&gt;      Ozarba apicalis Ozarba consanguis Ozarba corniculans Ozarba hemipolia Ozarba madanda</span></span>
<span><span class="co">#&gt;      Palaeaspilates inoffensa Panotima angularis Pardasena roeselioides Pardasena virgulana</span></span>
<span><span class="co">#&gt;      Pardoxia graellsii Paschiodes mesoleucalis Phytometra fragilis Phytometra opsiphora</span></span>
<span><span class="co">#&gt;      Phytometra sacraria Platyptilia farfarellus Plecoptera resistens Plecopterodes melliflua</span></span>
<span><span class="co">#&gt;      Pleiomorpha homotypa Poliobotys ablactalis Polyhymno chionarcha Polypogon gigantalis</span></span>
<span><span class="co">#&gt;      Polypogon venata Popoudina linea Prasinocyma immaculata Precis archesia archesia</span></span>
<span><span class="co">#&gt;      Prionapteryx brevivittalis Prionofrontia strigata Proschaliphora albida Pseudoclanis postica</span></span>
<span><span class="co">#&gt;      Pseudonoorda rubricostalis Pseudozarba aethiops Pseudozarba bipartita Pseudozarba schencki</span></span>
<span><span class="co">#&gt;      Psilocerea cneca Ptychopseustis sharporum Pusiola interstiteola Pyrausta phoenicealis</span></span>
<span><span class="co">#&gt;      Rhodogastria similis Saenura flava Salvatgea xanthosoma Scopula accentuata</span></span>
<span><span class="co">#&gt;      Scopula erinaria isolata Scopula inscriptata Scopula nigrinotata Scopula sinnaria</span></span>
<span><span class="co">#&gt;      Scopula spoliata Somatina ctenophora Sommeria meridionalis Sozusa scutellata</span></span>
<span><span class="co">#&gt;      Sphingonaepiopsis nana Stathmopoda lychnacma Stenodacma wahlbergi Stoermeriana aculeata</span></span>
<span><span class="co">#&gt;      Tachosa fumata Tathorhynchus exsiccata Tebenna micalis Tegiapa larentiodes</span></span>
<span><span class="co">#&gt;      Teracotona metaxantha Terpnostola ardescens Thaumatotibia leucotreta Thysanoplusia exquisita</span></span>
<span><span class="co">#&gt;      Timora albisticta Tracheplexia lucia Trida barberae barberae Trigonodes exportata</span></span>
<span><span class="co">#&gt;      Udea infuscalis Ulotrichopus fatilega Ulotrichopus primulina Ulotrichopus tinctipennis</span></span>
<span><span class="co">#&gt;      Victoria triplaga Vittaplusia vittata Westermannia convergens Xyrosaris secreta</span></span>
<span><span class="co">#&gt;      Yponomeuta fumigatus Zamarada pulverosa Zygophyxia roseocincta Antheua tricolor Argema mimosae</span></span>
<span><span class="co">#&gt;      Rhanidophora ridens Heniocha apollonia Achaea illustrata Acleros mackenii mackenii</span></span>
<span><span class="co">#&gt;      Acontia tetragonisa Aiteta thermistis Allochrostes saliata Amata pseudosimplex Amata rendalli</span></span>
<span><span class="co">#&gt;      Amauris echeria echeria Amphicallia bellatrix Androlymnia torsivena Arniocera erythropyga</span></span>
<span><span class="co">#&gt;      Atrasana concolor Atrasana postica Attatha barlowi Audea blochwitzi Bamra marmorifera</span></span>
<span><span class="co">#&gt;      Borbo fatuellus Brachypecta perobliqua Ceromitia trigoniferella Chalciope delta</span></span>
<span><span class="co">#&gt;      Charaxes achaemenes Charaxes achaemenes achaemenes Charaxes cithaeron Chiasmia multistrigata</span></span>
<span><span class="co">#&gt;      Chiasmia umbrata Chrysopoloma isabellina Cleora betularia Coenobasis amoena</span></span>
<span><span class="co">#&gt;      Colpocheilopteryx operatrix Compsoctena aedifica Compsoctena brachyctenis Corgatha micropolia</span></span>
<span><span class="co">#&gt;      Cosmia polymorpha Cropera testacea Ctenusa pallida Ctenusa varians Desmeocraera octoginta</span></span>
<span><span class="co">#&gt;      Deudorix diocles Dysgonia proxima Ecpatia dulcistriga Ectropa ancilis Endotricha erythralis</span></span>
<span><span class="co">#&gt;      Epilepia melanobrunnea Eutelia leucodelta Ghesquierellana hirtusalis Gigantoceras rectilinea</span></span>
<span><span class="co">#&gt;      Glyphodes sycina Grammiphlebia striata Grammodora nigrolineata Graphium angolanus</span></span>
<span><span class="co">#&gt;      Heliothis flavirufa Hemiceratoides sittaca Hemijana variegata Heraclia africana</span></span>
<span><span class="co">#&gt;      Hyblaea occidentalium Hyblaea puera Hypocala deflorata Idaea malescripta Idaea purpurascens</span></span>
<span><span class="co">#&gt;      Iolaus silarus Isocentris filalis Janomima dannfelti Janomima mariana Junonia elgiva</span></span>
<span><span class="co">#&gt;      Junonia natalica Junonia natalica natalica Junonia oenone Knappetra fasciata Kroonia natalica</span></span>
<span><span class="co">#&gt;      Lacipa sexpunctata Lantzodes obovalis Leucotrachea leucomelanica Lichenopteryx despecta</span></span>
<span><span class="co">#&gt;      Lophocrama phoenicochlora Lophorrhachia rubricorpus Lopiena rubritincta Macropoliana natalensis</span></span>
<span><span class="co">#&gt;      Melanocera menippe Mittonia hampsoni Mylothris rueppellii Myrina dermaptera Neaxestis rhoda</span></span>
<span><span class="co">#&gt;      Neomocena convergens Nephele peneus Nephele vau Neptis laeta Neptis saclava</span></span>
<span><span class="co">#&gt;      Neromia rubripunctilla Notocerura spiritalis Obtusipalpis pardalis Odontestis striata</span></span>
<span><span class="co">#&gt;      Oedipygilema aposema Oligographa juniperi Ozarba plagifera Ozola pulverulenta Palpita elealis</span></span>
<span><span class="co">#&gt;      Parachalciope mahura Paracroria griseocincta Parotis prasinophila Pasiphila lita</span></span>
<span><span class="co">#&gt;      Pentila tropicalis Pericyma mendax Phalanta eurytis Phalanta phalantha Phytometra duplicalis</span></span>
<span><span class="co">#&gt;      Pingasa ruginaria Plateoplia acrobelia Platysphinx piabilis Plecoptera laniata</span></span>
<span><span class="co">#&gt;      Prasinocyma oculata Prasinocyma pictifimbria Precis octavia sesamus Precis tugela</span></span>
<span><span class="co">#&gt;      Prionofrontia erygidia Pseudacraea boisduvalii Pseudacraea boisduvalii trimenii</span></span>
<span><span class="co">#&gt;      Pseudacraea lucretia Pseudacraea lucretia expansa Pseudobunaea natalensis Pseudoclanis molitor</span></span>
<span><span class="co">#&gt;      Pseudolyra distincta Pseudonaclia puella Pyrausta tetraplagalis Rhanidophora cinctigutta</span></span>
<span><span class="co">#&gt;      Salagena tessellata Sarangesa motozi Sarimarais bicolor Schausia coryndoni</span></span>
<span><span class="co">#&gt;      Scopula fimbrilineata Sevenia boisduvali Siccia punctipennis Siccia sordida Soligena juna</span></span>
<span><span class="co">#&gt;      Somatina centrophora Stemmatophalera curvilinea Stenoglene rosea Syllepte nasonalis</span></span>
<span><span class="co">#&gt;      Syllepte vagans Syngatha latiflavaria Telchinia burni Telchinia serena Teragra althodes</span></span>
<span><span class="co">#&gt;      Terias floricola Thacona stictica Thiacidas berenice Thiacidas senex Tuxentius melaena</span></span>
<span><span class="co">#&gt;      Westermannia oediplaga Xanthopan morganii Zamarada differens Zamarada transvisaria</span></span>
<span><span class="co">#&gt;      Zerenopsis lepida Chiasmia streniata Amata cerbera Cacyreus lingeus Cucullia consimilis</span></span>
<span><span class="co">#&gt;      Derriodes oinophora Pasiphila derasata Prionapteryx molybdella Acontia natalis</span></span>
<span><span class="co">#&gt;      Agaphthora toxotes Drepanogynis determinata Lasiochlora diducta Oaracta auricincta</span></span>
<span><span class="co">#&gt;      Pareclipsis oxyptera Psilocerea pulverosa Sameodesma xanthocraspia Ulotrichopus mesoleuca</span></span>
<span><span class="co">#&gt;      Knappetra fasciata stellata Amata kuhlweinii Eurrhyparodes bracteolalis Acrapex festiva</span></span>
<span><span class="co">#&gt;      Allochrostes impunctata Apleroneura tripartita Bunaeopsis arabella Chiasmia tecnium</span></span>
<span><span class="co">#&gt;      Cinabra hyperbius Eublemma bolinia Gymnogramma pyrozancla Hemijana subrosea</span></span>
<span><span class="co">#&gt;      Mimoclystia pudicata quaggaria Mimoclystia undulosata Nassinia pretoria Parapoynx stagnalis</span></span>
<span><span class="co">#&gt;      Rigema ornata Rohaniella pygmaea Trichophysetis flavimargo Trichopisthia igneotincta</span></span>
<span><span class="co">#&gt;      Nudaurelia cytherea Acontia caffraria Choristoneura heliaspis Crocosia mesosticta</span></span>
<span><span class="co">#&gt;      Cryptophlebia peltastica Cyana pretoriae Deltote megalena Epiplema reducta Idaea sublimbaria</span></span>
<span><span class="co">#&gt;      Metarctia lateritia Parainesis restricta Paraona interjecta Rhodophthitus commaculata</span></span>
<span><span class="co">#&gt;      Spialia ferax Stathmopoda crassella Teracotona rhodophaea Crudaria leroma</span></span>
<span><span class="co">#&gt;      Ochropleura leucogaster Telchinia rahira rahira Alytarchia amanda Leptotes pulchra pulchra</span></span>
<span><span class="co">#&gt;      Leucochlaena aenigma Gonimbrasia tyrrhea Anedhella rectiradiata Calliodes pretiosissima</span></span>
<span><span class="co">#&gt;      Henometa clarki Oglasa renilinea Phthonandria pinguis Terias brigitta</span></span>
<span><span class="co">#&gt;      Papilio ophidicephalus ayresi Papilio ophidicephalus Afrogegenes letterstedti Heraclia superba</span></span>
<span><span class="co">#&gt;      Phiala pretoriana Junonia orithya madagascariensis Cassionympha cassius</span></span>
<span><span class="co">#&gt;      Colocleora divisaria divisaria Belenois zochalia zochalia Eupithecia immodica Mythimna tincta</span></span>
<span><span class="co">#&gt;      Apisa canescens Azygophleps asylas Braura truncatum Cuneisigna rivulata Gonometa postica</span></span>
<span><span class="co">#&gt;      Heniocha dyops Hoplistopus penricei Metarbela naumanni Tolna sypnoides Catochria catocaloides</span></span>
<span><span class="co">#&gt;      Selenistis annulella Afrobirthama flaccidia Colpocheilopteryx callichroma</span></span>
<span><span class="co">#&gt;      Conchylia lapsicolumna Gonimbrasia belina Gonometa rufobrunnea Acontia transfigurata</span></span>
<span><span class="co">#&gt;      Ctenoplusia molybdina Cucullia inaequalis Disclisioprocta natalata Ericeia inangulata</span></span>
<span><span class="co">#&gt;      Ligdia batesii Nausinoe quadrinalis Precis archesia Scopula caesaria Scopula minorata</span></span>
<span><span class="co">#&gt;      Scopula sublobata Sicyodes costipicta Spodoptera exempta Euproctis rufopunctata</span></span>
<span><span class="co">#&gt;      Achaea indeterminata Macroglossum trochilus trochilus Siccia tsitsikamma Kedestes lenis lenis</span></span>
<span><span class="co">#&gt;      Afromurzinia lutescens Anomis sabulifera Lacipa gemmata Zamarada metallicata</span></span>
<span><span class="co">#&gt;      Pardopsis punctatissima Argyrophora variabilis Anthene livida Coeliades forestan</span></span>
<span><span class="co">#&gt;      Euproctis subalba Gegenes pumilio gambica Grammodes bifasciata Heteropalpia cortytoides</span></span>
<span><span class="co">#&gt;      Mylothris rueppellii haemus Paralacydes arborifera Pinacopteryx eriphia eriphia</span></span>
<span><span class="co">#&gt;      Plodia interpunctella Thysanoplusia daubei Uranothauma nubifer nubifer Ctenoplusia furcifera</span></span>
<span><span class="co">#&gt;      Metisella metis paris Menophra obtusata Ethmia circumdatella Attatha attathoides</span></span>
<span><span class="co">#&gt;      Colotis evagore Colotis evagore antigone Pinacopteryx eriphia Lysceia flava Tarsocera cassina</span></span>
<span><span class="co">#&gt;      Stemmatophalera sjostedti Scopula dissonans Telchinia rahira Phyllaliodes flavida</span></span>
<span><span class="co">#&gt;      Amerila vitrea Audea bipunctata Botyodes asialis Miniodes discolor Radara vacillans</span></span>
<span><span class="co">#&gt;      Rhodesia alboviridata Eyralpenus testaceus Derriodes hilaris Eudalaca semicanus</span></span>
<span><span class="co">#&gt;      Ceratophaga vastellus Culladia serranella Lacipa nobilis Spodoptera apertura</span></span>
<span><span class="co">#&gt;      Marblepsis melanocraspis Plutographa encharacta Tracheplexia albimacula Dira clytus clytus</span></span>
<span><span class="co">#&gt;      Dasychira rocana Erastria madecassaria natalensis Lhommeia subapicata Cephonodes hylas</span></span>
<span><span class="co">#&gt;      Arniocera auriguttata Batocnema africana Celidomphax quadrimacula Colocleora proximaria</span></span>
<span><span class="co">#&gt;      Glyphodes bicoloralis Ludia delegorguei Secusio strigata Ustjuzhania lineata Ozarba gonatia</span></span>
<span><span class="co">#&gt;      Achaea dasybasis Eutelia subrubens Hypsopygia sanguinalis Phytometra subflavalis</span></span>
<span><span class="co">#&gt;      Chrysoritis chrysaor natalensis Serrodes trispila Negeta ruficeps Azanus ubaldus</span></span>
<span><span class="co">#&gt;      Cacoethes polidamon Charaxes pelias Chrysoritis chrysaor Chrysoritis chrysaor chrysaor</span></span>
<span><span class="co">#&gt;      Chrysoritis chrysaor midas Derriodes arcuifera Dira clytus Iolaus mimosae</span></span>
<span><span class="co">#&gt;      Myrina silenus ficedula Neurosymploca kushaica Phasis braueri Stygionympha irrorata</span></span>
<span><span class="co">#&gt;      Stygionympha vigilans Tarsocera cassus cassus Tarsocera fulvina Tylopaedia sardonyx</span></span>
<span><span class="co">#&gt;      Tylopaedia sardonyx sardonyx Ypthima asterope hereroica Papilio echerioides echerioides</span></span>
<span><span class="co">#&gt;      Attatha superba Deltote johnjoannoui Heraclia perdix Problepsis figurata Rhodoneura flavicilia</span></span>
<span><span class="co">#&gt;      Risoba sticticraspis Westermannia roseitincta Pseudonaclia bifasciata Pycnarmon cribrata</span></span>
<span><span class="co">#&gt;      Ulopeza conigeralis Laelia punctulata Mocis conveniens Zamarada adiposata Acontia mionides</span></span>
<span><span class="co">#&gt;      Chiasmia grimmia Hypotacha parva Pseudozarba opella Anthene definita definita</span></span>
<span><span class="co">#&gt;      Prionapteryx albimaculalis Rhinobombyx cuneata Azanus natalensis Heniocha marnois</span></span>
<span><span class="co">#&gt;      Nymphalidae indet. Charaxes saturnus Hippotion spec. Parascotia lamprolophoides</span></span>
<span><span class="co">#&gt;      Catephia amplificans Amata johanna Compsotata elegantissima Eicochrysops messapus messapus</span></span>
<span><span class="co">#&gt;      Afraltha chionostola Asinusca atricornis Odontocheilopteryx myxa Praedora marshalli</span></span>
<span><span class="co">#&gt;      Cabera elatina Appias epaphia contracta Chloroclystis gymnoscelides Euchrysops barkeri</span></span>
<span><span class="co">#&gt;      Euchrysops malathana Platylesches moritili Problepsis vestalis Sena prompta Zamarada erugata</span></span>
<span><span class="co">#&gt;      Entomogramma pardus Scotinochroa inconsequens Acrobasis viridella Cigaritis namaquus</span></span>
<span><span class="co">#&gt;      Miantochora venerata Cacyreus fracta Nephele funebris Temnora fumosa Arsacia rectalis</span></span>
<span><span class="co">#&gt;      Veniliodes pantheraria Bostra carnicolor Aethaloessa floridalis Ceromitia turpisella</span></span>
<span><span class="co">#&gt;      Exilisia bipuncta Meganola argyrolepis Leptomyrina hirundo Pseudomaenas bivirgata Aizoa namaqua</span></span>
<span><span class="co">#&gt;      Ceromitia punctulata Kuja squamigera Omizodes ocellata Pararethona hierax Sena prompta prompta</span></span>
<span><span class="co">#&gt;      Tegiapa melanoleuca Zobida similipuncta Estigmene internigralis Scotopteryx horismodes</span></span>
<span><span class="co">#&gt;      Alenia sandaster Anthene larydas Basiothia charis Charaxes brutus Cigaritis natalensis</span></span>
<span><span class="co">#&gt;      Leptomyrina gorgias gorgias Mesoptila festiva Ozarba abscissa Pseudobunaea tyrrhena</span></span>
<span><span class="co">#&gt;      Stephenia oncaea oncaea Terias floricola floricola Tuxentius melaena melaena Achaea mormoides</span></span>
<span><span class="co">#&gt;      Audea tegulata Chionopora tarachodes Chiromachla leuconoe Epiplema anomala</span></span>
<span><span class="co">#&gt;      Eudasychira georgiana Eurosia lineata Heliophisma klugii Leucostrophus alterhirundo</span></span>
<span><span class="co">#&gt;      Maruca vitrata Odontosida magnifica Omphacodes punctilineata Temnora funebris Urota sinope</span></span>
<span><span class="co">#&gt;      Afrospilarctia dissimilis Eicochrysops messapus Aloeides thyra thyra Bombycomorpha dukei</span></span>
<span><span class="co">#&gt;      Trichophysetis whitei Crinipus marisa Melampias huebneri huebneri Petovia marginata</span></span>
<span><span class="co">#&gt;      Pseudorethona albicans Temnora marginata Teracotona submacula Teragra macroptera</span></span>
<span><span class="co">#&gt;      Automolis meteus Anomoeotes nigrivenosus Eublemmistis chlorozonea Peratodonta heterogyna</span></span>
<span><span class="co">#&gt;      Eublemma glaucizona Freyeria trochylus Dira clytus eurina Aloeides oreas Eutricha obscura</span></span>
<span><span class="co">#&gt;      Orachrysops Rhypopteryx kettlewelli Hampsonata phoenicia natalithala Pseudonympha magoides</span></span>
<span><span class="co">#&gt;      Rhanidophora phedonia Rhanidophora aurantiaca Acidaliastis prophanes Conchyliodes distelitis</span></span>
<span><span class="co">#&gt;      Scopula sincera Stephenia aglaonice Bonaberiana crassisquama Chrysopoloma rudis</span></span>
<span><span class="co">#&gt;      Pseudomaenas leucograpta Tyria jacobaeae Colotis ione Coeliades keithloa Leptomyrina gorgias</span></span>
<span><span class="co">#&gt;      Tinea pellionella Tarucus sybaris Chiasmia furcata Idaea fumilinea Lomographa indularia</span></span>
<span><span class="co">#&gt;      Psalis africana Traminda neptunaria Lachnocnema laches Grammodes exclusiva Aloeides henningi</span></span>
<span><span class="co">#&gt;      Actizera lucida Eudalaca rufescens Grammodes euclidioides Heterorachis despoliata</span></span>
<span><span class="co">#&gt;      Oedicentra albipennis Poloma castanea Zekelita antistropha Stygionympha curlei</span></span>
<span><span class="co">#&gt;      Glyphodes amphipeda Sicyodes costipicta olearis Acontia antica Eudalaca crudeni</span></span>
<span><span class="co">#&gt;      Problepsis aegretta aegretta Problepsis digammata Rhenea michii Paralethe dendrophilus</span></span>
<span><span class="co">#&gt;      Colotis auxo Lepidochrysops oreas oreas Praezygaena agria Colotis pallene Amata longipes</span></span>
<span><span class="co">#&gt;      Charaxes cithaeron cithaeron Eurytela hiarbas Mocis mutuaria Lachnoptera ayresii Precis ceryne</span></span>
<span><span class="co">#&gt;      Axiocerses tjoane Charaxes wakefieldi Graphium policenes Iolaus silas Amata kilimandjaronis</span></span>
<span><span class="co">#&gt;      Nepheronia buquetii buquetii Nepheronia argia variegata Dixeia charina charina Colotis annae</span></span>
<span><span class="co">#&gt;      Eicochrysops messapus mahallakoaena Eagris nottoana nottoana Catacroptera cloanthe cloanthe</span></span>
<span><span class="co">#&gt;      Lantanophaga pusillidactylus Anoba atriplaga Ethmia austronamibiensis Amauris niavius</span></span>
<span><span class="co">#&gt;      Catalebeda cuneilinea Epigynopteryx termininota Lophotavia chalybescens Hypopyra carneotincta</span></span>
<span><span class="co">#&gt;      Neoclanis basalis Pithyllis metachryseis Acantharctia latifasciata Argyrographa moderata</span></span>
<span><span class="co">#&gt;      Eagris nottoana knysna Plusiodonta natalensis Achaea klugii Artitropa erinnys</span></span>
<span><span class="co">#&gt;      Bematistes aganice aganice Euproctis terminalis Paralethe dendrophilus indosa</span></span>
<span><span class="co">#&gt;      Arcyophora longivalvis Dichromia erastrialis Salagena narses Aloeides aranda Eublemma rivula</span></span>
<span><span class="co">#&gt;      Baorini Chiasmia amarata Fodina embolophora Oediblemma trogoptera Temnora inornata</span></span>
<span><span class="co">#&gt;      Eutricha bifascia Drepanogynis fuscimargo Ceromitia mioclina Conchylia ditissimaria</span></span>
<span><span class="co">#&gt;      Macrotarsipodes tricinctus Diasemia lunalis Charaxes jahlusa Graphium angolanus angolanus</span></span>
<span><span class="co">#&gt;      Graphium colonna Graphium leonidas Chlorissa dorsicristata Polyptychus grayii</span></span>
<span><span class="co">#&gt;      Stemorrhages sericea Lozotaenia capensana Metahepialus xenoctenis Thestor camdeboo</span></span>
<span><span class="co">#&gt;      Epipleminae indet. Charaxes jahlusa jahlusa Grammodes spec. Hypsopygia spec.</span></span>
<span><span class="co">#&gt;      Isturgia catalaunaria Lachnocnema spec. Leptomyrina spec. Mixocera spec. Stenoglene spec.</span></span>
<span><span class="co">#&gt;      Leptotes pirithous-complex Eoophyla capensis Charaxes zoolina zoolina Xanthodes brunnescens</span></span>
<span><span class="co">#&gt;      Charaxes jasius saturnus Parapoynx diminutalis Dysgonia properans Junonia orithya</span></span>
<span><span class="co">#&gt;      Aloeides almeida Cassionympha detecta Capys alpheus alpheus Lepidochrysops robertsoni</span></span>
<span><span class="co">#&gt;      Ancylolomia chrysographellus Cecidothyris pexa pexa Hemerophanes libyra flammeola</span></span>
<span><span class="co">#&gt;      Platylesches neba Sena donaldsoni marshalli Tantaliana tantalus Colotis auxo auxo Aloeides</span></span>
<span><span class="co">#&gt;      Anaphe panda Baliochila aslanga Bareia incidens Erastria madecassaria</span></span>
<span><span class="co">#&gt;      Herpetogramma phaeopteralis Hypobleta viettei Lirabotys prolausalis Polythlipta annulifera</span></span>
<span><span class="co">#&gt;      Zebronia phenice Gymnelema vinctus Hypena conscitalis Lamprosema lucillalis</span></span>
<span><span class="co">#&gt;      Myrina dermaptera dermaptera Omocenoides isophanes Pseudochromatosia nigrapex</span></span>
<span><span class="co">#&gt;      Cymothoe coranus coranus Eudalaca orthocosma Haritalodes polycymalis Pramadea ovialis</span></span>
<span><span class="co">#&gt;      Psilocladia obliquata Eublemma aurantiaca Rhesala natalensis Piercia smaragdinata</span></span>
<span><span class="co">#&gt;      Afrodryas leda Bematistes aganice Coelonia fulvinotata fulvinotata Telchinia igola</span></span>
<span><span class="co">#&gt;      Traminda falcata Amsacta grammiphlebia Anadiasa punctifascia Galtara nepheloptera</span></span>
<span><span class="co">#&gt;      Leptolepida varians Neromia rhodomadia Paragathia albimarginata Paraxestis rufescens</span></span>
<span><span class="co">#&gt;      Urapteroides recurvata Abantis tettensis Stygionympha scotina scotina Acontia porphyrea</span></span>
<span><span class="co">#&gt;      Thiacidas roseotincta Parosmodes morantii Theretra cajus Euchrysops osiris</span></span>
<span><span class="co">#&gt;      Cnaphalocrocis trebiusalis Metisella metis Myrina silenus Pygospila tyres Aeropetes tulbaghia</span></span>
<span><span class="co">#&gt;      Polypogon melanommoides Colotis calais Cacyreus Aloeides trimeni trimeni Leucania loreyi</span></span>
<span><span class="co">#&gt;      Bombycopsis capicola Ozarba domina Lepidochrysops plebeia plebeia Coenyropsis natalii natalii</span></span>
<span><span class="co">#&gt;      Nudaurelia wahlbergii Ogoa simplex Axiocerses tjoane tjoane Chrysoritis palmus palmus</span></span>
<span><span class="co">#&gt;      Trimenia macmasteri macmasteri Trimenia macmasteri Brakefieldia perspicua Willema willemi</span></span>
<span><span class="co">#&gt;      Aloeides taikosama Ernsta nanus Nervia wallengrenii wallengrenii Charaxes varanes Gomalia elma</span></span>
<span><span class="co">#&gt;      Nyodes lutescens Colotis regina Aloeides arida Aloeides penningtoni Amauris echeria</span></span>
<span><span class="co">#&gt;      Caligatus angasii Creagra liturata Eretis Eutelia catephioides Hippotion osiris</span></span>
<span><span class="co">#&gt;      Aloeides thyra orientis Plegapteryx anomalus Temnora zantus Hondryches phalaeniformis</span></span>
<span><span class="co">#&gt;      Aloeides damarensis damarensis Amata phaeobasis Tsitana dicksoni Pseudonympha trimenii trimenii</span></span>
<span><span class="co">#&gt;      Sarimarais peringueyi Aloeides pallida jonathani Aloeides vansoni Euproctis sanguigutta</span></span>
<span><span class="co">#&gt;      Ligdia pectinicornis Neaxestis griseata Taeda aetitis Psycharium pellucens</span></span>
<span><span class="co">#&gt;      Nausinoella aphrospila Zintha hintza hintza Teracolus eris Meliaba pelopsalis</span></span>
<span><span class="co">#&gt;      Coptoproctis languida Bryophilopsis lunifera Eublemma alexi Heliothela ophideresana</span></span>
<span><span class="co">#&gt;      Homochira rendalli Isocentris charopalis Zamarada plana Axiodes circumroda Prosomphax callista</span></span>
<span><span class="co">#&gt;      Leptotes Acontia wahlbergi Nassinia aurantiaca Pseudonympha magus Ulotrichopus catocala</span></span>
<span><span class="co">#&gt;      Ceryx fulvescens Loxopora dentilineata Acontia aurelia Brakefieldia perspicua perspicua</span></span>
<span><span class="co">#&gt;      Cropera phlebitis Desmeocraera latex Dotta callicles Ernsta colotes transvaaliae</span></span>
<span><span class="co">#&gt;      Graphium porthaon porthaon Hemiolaus caeculus caeculus Nepheronia thalassina sinalata</span></span>
<span><span class="co">#&gt;      Penicillaria ethiopica Physcaeneura panda Pseudoclanis staudei Sarangesa phidyle</span></span>
<span><span class="co">#&gt;      Sarangesa seineri Chiasmia inconspicua Eublemma seminivea Isoplenia trisinuata</span></span>
<span><span class="co">#&gt;      Euplexia catephiodes Acropteris illiturata Bicyclus ena Corgatha albigrisea</span></span>
<span><span class="co">#&gt;      Heterostegane rectistriga Lacipa pulverea Phazaca theclata Phiala incana Racinoa ficicola</span></span>
<span><span class="co">#&gt;      Rigema woerdeni Scopula ruficolor Trachonitis capensis Papilio echerioides Eudalaca homoterma</span></span>
<span><span class="co">#&gt;      Axiodes pallidimargo Ectochela ossicolor Catephia discophora Cacyreus virilis</span></span>
<span><span class="co">#&gt;      Uranothauma nubifer Thestor murrayi Ceryx anthraciformis Gomalia elma elma Temnora pylades</span></span>
<span><span class="co">#&gt;      Bombycomorpha bifascia bifascia Autocharis albiplaga Barrama impunctata Cucullia terensis</span></span>
<span><span class="co">#&gt;      Heterostegane auranticollis Kotochalia junodi Lophostola atridisca Acontia citripennis</span></span>
<span><span class="co">#&gt;      Eublemma flavida Chasmina vestae Derriodes latipennis Abantis canopus Achaea albitermia</span></span>
<span><span class="co">#&gt;      Amata schellhorni Chiasmia brongusaria brongusaria Chiasmia feraliata Eretmocera syleuta</span></span>
<span><span class="co">#&gt;      Eucraera gemmata Hippotion rosae Laelia hampsoni Leocyma appollinis Lygropia tetraspilalis</span></span>
<span><span class="co">#&gt;      Ozarba bipartita Parotis baldersalis Pentila tropicalis fuscipunctata Stenopis tumiditermina</span></span>
<span><span class="co">#&gt;      Zamarada deceptrix Zamarada varii Zeuctoboarmia cataimena Hippotion balsaminae Anomis luperca</span></span>
<span><span class="co">#&gt;      Hebdomophruda nigroviridis Omphalucha albosignata Colotis antevippe Hypotia bolinalis</span></span>
<span><span class="co">#&gt;      Arbelodes franziskae Rhabdosia patagiata Coeliades libeon Phalanta eurytis eurytis</span></span>
<span><span class="co">#&gt;      Pseudacraea eurytus Acraeini Tarucus sybaris sybaris Eutomis minceus Platylesches ayresii</span></span>
<span><span class="co">#&gt;      Isturgia exerraria Cymothoe alcimeda trimeni Harpendyreus noquasa Amerila affinis</span></span>
<span><span class="co">#&gt;      Cyclopera bucephalidia Phoenicocampa terinata Ruanda furva Phragmatobia parvula</span></span>
<span><span class="co">#&gt;      Caffricola vicina Tsitana uitenhaga Phasis thero Problepsis aegretta Ernsta delagoae</span></span>
<span><span class="co">#&gt;      Lacera alope Charaxes phaeus Lebedodes rufithorax Lepidochrysops patricia Semyrilla lineata</span></span>
<span><span class="co">#&gt;      Aroa difficilis Artitropa erinnys erinnys Callioratis abraxas Cerurella natalensis</span></span>
<span><span class="co">#&gt;      Drepanogynis monas Drepanogynis valida Glyphodes aniferalis Herpetogramma licarsisalis</span></span>
<span><span class="co">#&gt;      Janthinisca joannoui Lobobunaea angasana Negera natalensis Neromia impostura</span></span>
<span><span class="co">#&gt;      Omphalestra mesoglauca Paralethe dendrophilus dendrophilus Plusiodonta nictites</span></span>
<span><span class="co">#&gt;      Scopula straminea Sicyodes algoaria Spiramiopsis comma Streblote polydora Syllepte orbiferalis</span></span>
<span><span class="co">#&gt;      Temnora plagiata Teragra guttifera Vanessa hippomene hippomene Victoria fuscithorax</span></span>
<span><span class="co">#&gt;      Xenimpia maculosata Apallaga mokeezi mokeezi Horisme minuata Hydrillodes uliginosalis</span></span>
<span><span class="co">#&gt;      Spialia mafa mafa Argyraspodes argyraspis Hampsonita esmeralda Bicyclus anynana</span></span>
<span><span class="co">#&gt;      Stephenia caldarena Alonina pyrocraspis Colias electo electo Drepanogynis calotaenia</span></span>
<span><span class="co">#&gt;      Procanthia distantii Phylloxiphia metria Eudalaca vindex Ctenoplusia phocea Ligdia interrupta</span></span>
<span><span class="co">#&gt;      Pseudolarentia megalaria Chalcidoptera thermographa Amata khoisana Torynesis mintha mintha</span></span>
<span><span class="co">#&gt;      Caloptilia octopunctata Amyna natalica Petrodava leucicolor Epicosymbia nitidata</span></span>
<span><span class="co">#&gt;      Melinoessa croesaria Melampias huebneri Tsitana tulbagha Chrysoritis beaufortius charlesi</span></span>
<span><span class="co">#&gt;      Thestor montanus Tarsocera dicksoni Aphilopota decepta Maxera digoniata Euchrysops dolorosa</span></span>
<span><span class="co">#&gt;      Leto venus Deudorix dinochares Veniliodes setinata Stephenia axina Stygionympha vansoni</span></span>
<span><span class="co">#&gt;      Borbo fallax Idaea fumilinea confracta Polienus capillata Pseudocragia quadrinotata</span></span>
<span><span class="co">#&gt;      Aletis concolor Chrysoritis palmus Stugeta bowkeri Cassionympha camdeboo Charaxes</span></span>
<span><span class="co">#&gt;      Charaxes xiphares xiphares Cupidopsis cissus Eretis djaelaelae Adicocrita araria</span></span>
<span><span class="co">#&gt;      Autocharis fessalis Deltote olivula Drepanogynis admiranda Entephria epipercna</span></span>
<span><span class="co">#&gt;      Hypagoptera rufeola Ilemodes heterogyna Leucotrachea melanobasis Ochrocalama xanthia</span></span>
<span><span class="co">#&gt;      Pararethona argentescens Psalis securis Pseudobunaea epithyrena Pseudoradiarctia scita</span></span>
<span><span class="co">#&gt;      Psilocerea immitata Rhypopteryx rhodalipha Sicyodes variciliata Tegiapa goateri Temnora elegans</span></span>
<span><span class="co">#&gt;      Pseudonympha swanepoeli Syngamia fervidalis Kedestes macomo Lepidochrysops australis</span></span>
<span><span class="co">#&gt;      Culladia inconspicuellus Cigaritis ella Serradinga bowkeri bowkeri Euchrysops subpallida</span></span>
<span><span class="co">#&gt;      Axiodes anthracinata Derriodes villaria Axiodes dentatimargo Sicyodes ocellata</span></span>
<span><span class="co">#&gt;      Crudaria capensis Axiodes trachyacta Pareclipsis incerta Gorgopis angustiptera</span></span>
<span><span class="co">#&gt;      Hebdomophruda errans Pentila tropicalis tropicalis Aloeides thyra Durbaniopsis saga</span></span>
<span><span class="co">#&gt;      Precis tugela tugela Hypotia dinteri Metasia eremialis Sicyodes biviaria Caffricola cloeckneria</span></span>
<span><span class="co">#&gt;      Eudalaca exul Drepanogynis agrypna Philobota erastis Pyrausta procillusalis Aloeides swanepoeli</span></span>
<span><span class="co">#&gt;      Audea melanoplaga Sicyodes viridipennis Nyodes acatharta Pseudocatharylla xymena</span></span>
<span><span class="co">#&gt;      Heniocha bioculata Brephos festiva Caffrocrambus dichotomellus Paternympha narycia</span></span>
<span><span class="co">#&gt;      Stephenia stenobea Stygionympha wichgrafi Tsitana tsita Hypolycaena buxtoni Ozarba hypotaenia</span></span>
<span><span class="co">#&gt;      Antheua simplex Maliattha bethunebakeri Tegostoma bipartalis Lachnocnema durbani</span></span>
<span><span class="co">#&gt;      Precis ceryne ceryne Charaxes jahlusa rex Zutulba namaqua zelleri Euterpiodes pienaari</span></span>
<span><span class="co">#&gt;      Metisella malgacha Axiocerses croesus Pseudomaenas krooni Eois grataria Stugeta bowkeri tearei</span></span>
<span><span class="co">#&gt;      Callyna decora Amauris niavius dominicanus Cacyreus dicksoni Acontia paratrigona</span></span>
<span><span class="co">#&gt;      Triphassa stalachtis Nolidia unipuncta Eupithecia laticallis Aloeides damarensis mashona</span></span>
<span><span class="co">#&gt;      Arcyophora patricula Axiocerses coalescens Dysgonia triplocyma Oglasa nana Phalera imitata</span></span>
<span><span class="co">#&gt;      Plecoptera stuhlmanni Stemmatophora chloralis Tytroca leucoptera Unipectiphora delosignata</span></span>
<span><span class="co">#&gt;      Nassinia caffraria Cupidopsis jobates Apallaga mokeezi separata Colotis erone</span></span>
<span><span class="co">#&gt;      Parosmodes morantii morantii Procrateria basifascia Heniocha flavida Lamprolopha phaeomicta</span></span>
<span><span class="co">#&gt;      Axiocerses amanga Colotis calais calais Euphaedra neophron Nepheronia buquetii</span></span>
<span><span class="co">#&gt;      Agyllia asterodia Sommeria strabonis Lacipa gracilis Eutelia ocellaria Pseudandriasa mutata</span></span>
<span><span class="co">#&gt;      Pareclipsis punctata Yponomeuta africanus Cymothoe alcimeda Metachrostis postrufa</span></span>
<span><span class="co">#&gt;      Lepidochrysops variabilis Acontia umbrigera Praedora plagiata Tuta absoluta</span></span>
<span><span class="co">#&gt;      Afroplitis dasychirina Rubraea nohara Cymothoe alcimeda alcimeda Brephos decora</span></span>
<span><span class="co">#&gt;      Meganola bipartita Durbaniella clarki phaea Stephenia caldarena caldarena Bostra albilineata</span></span>
<span><span class="co">#&gt;      Metarctia rufescens Crionica cervicornis Iambia inferalis Aloeides pallida grandis</span></span>
<span><span class="co">#&gt;      Amyna punctum Cyclopera similis Isozinara pallidifascia Microbaena pulchra minor</span></span>
<span><span class="co">#&gt;      Selepa leucogonia Cerurographa bistonica Rubraea cerasa cerasa Thestor holmesi</span></span>
<span><span class="co">#&gt;      Automolis bicolora Chrysoritis palmus margueritae Thestor vansoni Eyralpenus subluteus</span></span>
<span><span class="co">#&gt;      Cirrodes phoenicea Neita extensa Chrysoritis pan pan Ludia orinoptena monroei</span></span>
<span><span class="co">#&gt;      Chrysoritis aethon Afrogluphisia dasychiroides Chrysoritis felthami felthami</span></span>
<span><span class="co">#&gt;      Chrysoritis thysbe thysbe Colias electo Euphiusa harmonica Vietteania intestata</span></span>
<span><span class="co">#&gt;      Aloeides molomo molomo Crothaema sericea Cupidopsis cissus cissus</span></span>
<span><span class="co">#&gt;      Stygionympha wichgrafi wichgrafi Astictopterus inornatus Appias epaphia Hesperiinae</span></span>
<span><span class="co">#&gt;      Metoeca foedalis Achaea rufobrunnea Acripia subolivacea Acrocercops chrysophylli</span></span>
<span><span class="co">#&gt;      Aethiopsestis austrina Callyna figurans Collix foraminata Ctenoplusia dorfmeisteri</span></span>
<span><span class="co">#&gt;      Ctenoplusia melanocephala Desmeocraera interpellatrix Eudocima lequeuxi Eutelia gaedei</span></span>
<span><span class="co">#&gt;      Goniocalpe heteromorpha Laelia curvivirgata Leucotrachea melanoleuca Macalla ignozonalis</span></span>
<span><span class="co">#&gt;      Megalonycta paragrapha Melanthia ustiplaga Stenopis maculata Syfanoidea schencki</span></span>
<span><span class="co">#&gt;      Temnora namaqua Thyas rubricata Borbo ferruginea dondo Anthene princeps Amauris</span></span>
<span><span class="co">#&gt;      Eretis umbra umbra Botyodes diniasalis Rosinella rosinaria Xenochroma candidata</span></span>
<span><span class="co">#&gt;      Chrysoritis zeuxo Neurosymploca naumanniola Aloeides egerides Zamarada ascaphes</span></span>
<span><span class="co">#&gt;      Charaxes xiphares kenwayi Eretis umbra Pseudonympha hippia Dysgonia algira</span></span>
<span><span class="co">#&gt;      Graphium policenes policenes Rubraea cerasa Acraea boopis Graphium morania</span></span>
<span><span class="co">#&gt;      Aphnaeus hutchinsonii Tuxentius calice Chrysoritis zonarius zonarius Ophiusa cancellata</span></span>
<span><span class="co">#&gt;      Leptomyrina henningi Tarsocera cassus Anthene lemnos Abantis levubu Lachnocnema</span></span>
<span><span class="co">#&gt;      Chrysoritis pan henningi Iolaus mimosae mimosae Stugeta bowkeri bowkeri Telchinia anacreon</span></span>
<span><span class="co">#&gt;      Aloeides trimeni Alaena amazoula Ypthima asterope Sarangesa seineri durbana Aloeides rossouwi</span></span>
<span><span class="co">#&gt;      Lepidochrysops ketsi leucomacula Creatonotos punctivitta Chrysoritis thysbe</span></span>
<span><span class="co">#&gt;      Bathycolpodes chloronesis Cabomina hilariformis Chiasmia natalensis Halseyia biumbrata</span></span>
<span><span class="co">#&gt;      Heraclia pardalina Scopula internata Zerenopsis geometrina Acontia conifrons Aletis libyssa</span></span>
<span><span class="co">#&gt;      Paralethe dendrophilus albina Cigaritis phanes Nervia mohozutza Ypthima impura paupera</span></span>
<span><span class="co">#&gt;      Chrysoritis felthami Thestor rossouwi Prasinocyma hadrata Thestor basuta basuta</span></span>
<span><span class="co">#&gt;      Syngatha argyropasta Papilio constantinus Aloeides dryas Aloeides pallida</span></span>
<span><span class="co">#&gt;      Lepidochrysops plebeia Latoia viridimixta Lepidochrysops oreas junae Teracolus agoye agoye</span></span>
<span><span class="co">#&gt;      Epicosymbia perstrigulata Lepidochrysops ignota Acontia margaritata Aloeides stevensoni</span></span>
<span><span class="co">#&gt;      Eretmocera laetissima Orna nebulosa Belenois zochalia Aloeides titei Azanus jesous jesous</span></span>
<span><span class="co">#&gt;      Euphaedra neophron neophron Serradinga clarki clarki Durbania amakosa flavida</span></span>
<span><span class="co">#&gt;      Cymothoe alcimeda transvaalica Aloeides simplex Negeta luminosa Knappetra arenacea</span></span>
<span><span class="co">#&gt;      Aegocera fervida Acontiola hypoxantha Cigaritis mozambica Tildia trimeni Choreutis aegyptiaca</span></span>
<span><span class="co">#&gt;      Anthene lemnos lemnos Paroruza subductata Neurosymploca caffra Macarostola noellineae</span></span>
<span><span class="co">#&gt;      Typhonia picea Orachrysops montanus Tissanga pretoriae Eudalaca leucocyma Polyommatinae</span></span>
<span><span class="co">#&gt;      Grammodes monodonta Aloeides gowani Aloeides nollothi Eupithecia sagittata Dingana angusta</span></span>
<span><span class="co">#&gt;      Beralade jordani Telchinia alalonga Hypotephrina serrimargo Idaea basicostalis</span></span>
<span><span class="co">#&gt;      Sporetolepis platti Clostera limacodina Pingasa spec. Charaxes spec. Pieridae indet.</span></span>
<span><span class="co">#&gt;      Eudalaca spec. Serradinga bowkeri Nola spec. Feliniopsis indigna Leptotes spec.</span></span>
<span><span class="co">#&gt;      Pterophoridae indet. Garella spec. Dixeia spec. Digama meridionalis Rhodoneura spec.</span></span>
<span><span class="co">#&gt;      Chrysoritis brooksi brooksi Rubraea violarum Chrysoritis irene Alaena amazoula amazoula</span></span>
<span><span class="co">#&gt;      Imbrasia gueinzii Trimenia argyroplaga argyroplaga Pitthea trifasciata</span></span>
<span><span class="co">#&gt;      Durbania amakosa albescens Cassionympha perissinottoi Borbo micans Aloeides pallida littoralis</span></span>
<span><span class="co">#&gt;      Durbania amakosa Spodoptera frugiperda Pseudophragmatobia parvula Eulycia extorris</span></span>
<span><span class="co">#&gt;      Bertula inconspicua Vanessa hippomene Trimenia argyroplaga Eublemma exigua</span></span>
<span><span class="co">#&gt;      Pontia helice subsp. helice Serradinga clarki amissivallis Scopula donovani Taeda gemmans</span></span>
<span><span class="co">#&gt;      Neogalea sunia Loryma sentiusalis Lepidochrysops trimeni Ambia chalcichroalis</span></span>
<span><span class="co">#&gt;      Neurosymploca affinis Platyja vacillans Gonimbrasia gueinzii Crothaema decorata</span></span>
<span><span class="co">#&gt;      Chrysoritis chrysantas Eudocima divitiosa Dixeia doxo parva Graphium porthaon</span></span>
<span><span class="co">#&gt;      Chrysoritis zeuxo zeuxo Hypotephrina exmotaria Tumicla tsonga Corgatha wojtusiaki</span></span>
<span><span class="co">#&gt;      Hypocala plumicornis Chrysoritis thysbe schloszae Loxostege plumbatalis</span></span>
<span><span class="co">#&gt;      Tsitana tulbagha kaplani Phalanta Chrysoritis uranus uranus Eudalaca cretata Polyommatini</span></span>
<span><span class="co">#&gt;      Melampias huebneri steniptera Chrysoritis mithras Thestor basuta Omphax bacoti</span></span>
<span><span class="co">#&gt;      Orphanostigma abruptalis Marathyssa cuneata Neostichtis nigricostata Abantis venosa</span></span>
<span><span class="co">#&gt;      Agyllia agylla agylla Pseudonympha trimenii ruthae Aloeides damarensis Orophia straminella</span></span>
<span><span class="co">#&gt;      Zamarada dentigera Aloeides depicta Selepa transvalica Azygophleps leopardina</span></span>
<span><span class="co">#&gt;      Stugeta subinfuscata Eupithecia rubiginifera Platylesches robustus robustus Anthene lindae</span></span>
<span><span class="co">#&gt;      Charaxes guderiana Dira jansei Plecoptera melalepis Pseudacraea eurytus imitator</span></span>
<span><span class="co">#&gt;      Chrysoritis zonarius Stugeta subinfuscata reynoldsi Aedia virescens Pelopidas mathias</span></span>
<span><span class="co">#&gt;      Charaxes etesipe tavetensis Myrina silenus penningtoni Pelopidas mathias mathias</span></span>
<span><span class="co">#&gt;      Hypochrosis meridionalis Apallaga mokeezi Cautatha drepanodes Bocchoris nuclealis</span></span>
<span><span class="co">#&gt;      Didymonyx infumata Banisia myrsusalis Eudalaca infumata Terastia indet.</span></span>
<span><span class="co">#&gt;      Colotis euippe subsp. omphale Danaus chrysippus subsp. orientis</span></span>
<span><span class="co">#&gt;      Protogoniomorpha anacardii subsp. nebulosa Dysodia antennata Euphyia distinctata</span></span>
<span><span class="co">#&gt;      Galtara pulverata Eugoa africana Odites sucinea Eulycia grisea grisea Phylloxiphia punctum</span></span>
<span><span class="co">#&gt;      Choreutis dryodora Ctenoplusia accentifera Orophia ammopleura Leptotes pirithous pirithous</span></span>
<span><span class="co">#&gt;      Heliothis peltigera Cynaeda distictalis Belenois creona subsp. severina</span></span>
<span><span class="co">#&gt;      Precis octavia subsp. sesamus Vanessa dimorphica Lepidochrysops frederikeae</span></span>
<span><span class="co">#&gt;      Scopula sinnaria bisinuata Metisella malgacha orina Chrysoritis pelion Eulycia grisea</span></span>
<span><span class="co">#&gt;      Stathmopoda maculata Alenia namaqua Aloeides margaretae Aurotalis nigrisquamalis</span></span>
<span><span class="co">#&gt;      Orachrysops nasutus nasutus Latoiola pusilla Harpendyreus tsomo Neurosymploca concinna</span></span>
<span><span class="co">#&gt;      Coenina dentataria Polelassothys plumitarsus Scopula caesaria caesaria Actizera stellata</span></span>
<span><span class="co">#&gt;      Hebdomophruda sculpta Antharmostes papilio Tarucus bowkeri bowkeri Loryma varians</span></span>
<span><span class="co">#&gt;      Chrysoritis pyroeis pyroeis Eretmocera impactella Theretra orpheus Teracolus agoye bowkeri</span></span>
<span><span class="co">#&gt;      Criocharacta amphiactis Teracolus agoye Teracolus subfasciatus Chiasmia spec. Anoba hamifera</span></span>
<span><span class="co">#&gt;      Campimoptilum kuntzei Zamarada spec. Phalanta spec. Maxera marchalii Somatina vestalis</span></span>
<span><span class="co">#&gt;      Euproctis spec. Pyrausta gemmiferalis Harpendyreus notoba Mylothris trimenia</span></span>
<span><span class="co">#&gt;      Aloeides trimeni southeyae Eurema Hamartia medora Risoba diplogramma</span></span>
<span><span class="co">#&gt;      Stygionympha scotina coetzeri Belenois creona creona Neptis jordani Lachnocnema bibulus</span></span>
<span><span class="co">#&gt;      Ozarba orthozona Estigmene trivitta Maxera Aphilopota patulata patulata Papilio euphranor</span></span>
<span><span class="co">#&gt;      Serradinga clarki dracomontana Aloeides juana Atacira mima Nepheronia argia varia</span></span>
<span><span class="co">#&gt;      Chlorosterrha monochroma Cleora nigrisparsalis Lepidochrysops Sarangesa seineri seineri</span></span>
<span><span class="co">#&gt;      Deudorix dariaves Lepidochrysops ketsi ketsi Kobelana krooni Eagris nottoana</span></span>
<span><span class="co">#&gt;      Lepidochrysops oreas Kedestes lenis Lepidochrysops methymna Hypolycaena buxtoni buxtoni</span></span>
<span><span class="co">#&gt;      Streblote capensis Dira oxylus Torynesis hawequas Stygionympha scotina</span></span>
<span><span class="co">#&gt;      Stygionympha wichgrafi grisea Cassionympha Pseudonympha paludis Dixeia Capys disjunctus</span></span>
<span><span class="co">#&gt;      Paralethe dendrophilus junodi Colotis Zizeeriina Nonagria intestata Parthenodes angularis</span></span>
<span><span class="co">#&gt;      Vietteania indet. Lepidoptera indet. Noctuidae indet. Belenois gidica subsp. abyssinica</span></span>
<span><span class="co">#&gt;      Metarctia indet. Callixena versicolora Torynesis Sevenia morantii Ernsta confusa</span></span>
<span><span class="co">#&gt;      Lepidochrysops methymna methymna Orachrysops mijburghi Kobelana kobela</span></span>
<span><span class="co">#&gt;      Lepidochrysops puncticilia Tildia barberi Iolaus sidus Nepheronia thalassina</span></span>
<span><span class="co">#&gt;      Platylesches galesa Iolaus trimeni Chrysoritis williami Ernsta colotes Dysgonia abnegans</span></span>
<span><span class="co">#&gt;      Pseudonympha Yponomeuta puncticornis Tytroca phaeocyma Myrina silenus silenus</span></span>
<span><span class="co">#&gt;      Chrysoritis turneri Praezygaena ochroptera Chrysoritis lyncurium lycegenes Gonimbrasia bubo</span></span>
<span><span class="co">#&gt;      Chrysoritis Stygionympha wichgrafi williami Durbania amakosa ayresi Stygionympha geraldi</span></span>
<span><span class="co">#&gt;      Lepidochrysops braueri Epigynopteryx ommatoclesis Luashia zonata Anthene talboti Aporiina</span></span>
<span><span class="co">#&gt;      Serradinga clarki Metisella meninx Borbo borbonica Rubraea nohara nohara Iolaus alienus</span></span>
<span><span class="co">#&gt;      Lepidochrysops asteris Hypolycaena lochmophila Plecoptera poderis Durbania amakosa penningtoni</span></span>
<span><span class="co">#&gt;      Utetheisa spec. Ypthima Alaena amazoula ochroma Charaxes vansoni Charaxes druceanus druceanus</span></span>
<span><span class="co">#&gt;      Palaeonyssia trisecta Ypthima impura impura Cymothoe alcimeda marieps Ateliotum crymodes</span></span>
<span><span class="co">#&gt;      Hypolimnas deceptor deceptor Sevenia Coeliades Nepheronia argia Metendothenia balanacma</span></span>
<span><span class="co">#&gt;      Trichoplusia ni Colotis lais Gnophodes diversa Precis antilope Chiasmia nobilitata</span></span>
<span><span class="co">#&gt;      Charaxes ethalion Axiocerses amanga amanga Chiasmia amarata amarata Braura picturata</span></span>
<span><span class="co">#&gt;      Chrysoritis beulah Ypthima impura Phasis clavum Deudorix Prasinocyma niveisticta Serradinga</span></span>
<span><span class="co">#&gt;      Carcharodina Chrysoritis zeuxo cottrelli Acraea machequena Rhabdophera hansali</span></span>
<span><span class="co">#&gt;      Charaxes druceanus Papilio ophidicephalus transvaalensis Zenonia zeno Aloeides nubilus</span></span>
<span><span class="co">#&gt;      Lepidochrysops procera Athetis satellitia Chrysoritis trimeni Byblia Macaldenia palumbiodes</span></span>
<span><span class="co">#&gt;      Hesperiini Coliadinae Aloeides quickelbergei Phereoeca uterella Metisella aegipan aegipan</span></span>
<span><span class="co">#&gt;      Piercia ciliata Tarucus bowkeri transvaalensis Caffrocrambus chalcimerus</span></span>
<span><span class="co">#&gt;      Papilio ophidicephalus phalusco Nervia chaca Ctenoplusia lavendula Stephenia lygus</span></span>
<span><span class="co">#&gt;      Thestor braunsi Coeliades anchises Aloeides maluti Dingana alticola Capys alpheus extentus</span></span>
<span><span class="co">#&gt;      Nervia nerva Athetis albirena Dixeia doxo Hipoepa fractalis Pseudonympha varii</span></span>
<span><span class="co">#&gt;      Eucrostes rhodophthalma Rhesala goleta Eublemma foedosa Scotopteryx cryptospilata</span></span>
<span><span class="co">#&gt;      Grammodes geometrica Hypomecis complacita Triphassa argentea Eochroa trimenii Axiodes niveata</span></span>
<span><span class="co">#&gt;      Perizoma petrogenes Cleora acaciaria Thestor yildizae Torynesis magna Hypena jussalis</span></span>
<span><span class="co">#&gt;      Hypena laetalis Aethiopodes erebaria Phasis clavum erythema Aristaea thalassias</span></span>
<span><span class="co">#&gt;      Omphalucha indeflexa Zorostola melanoxantha Proschaliphora butti Axiodes albilinea</span></span>
<span><span class="co">#&gt;      Eupithecia infelix Chrysoritis rileyi Aloeides barklyi Colotis doubledayi Felderiola candescens</span></span>
<span><span class="co">#&gt;      Stygionympha robertsoni Aloeides bamptoni Lepidochrysops penningtoni Phasis clavum clavum</span></span>
<span><span class="co">#&gt;      Spialia Chrysoritis braueri Axiodes irvingi Blepharucha zaide Pieris brassicae brassicae</span></span>
<span><span class="co">#&gt;      Tathorhynchus plumbea Cymothoe coranus Rhodafra opheltes Eublemma flaviceps Eudalaca ibex</span></span>
<span><span class="co">#&gt;      Scopula argentidisca Cabera pseudognophos Ancylolomia prepiella Cyana capensis</span></span>
<span><span class="co">#&gt;      Eublemma costimacula microleuca Thyretes montana Drepanogynis incondita Torynesis mintha</span></span>
<span><span class="co">#&gt;      Spialia diomus Euproctis arenacea Veniliodes inflammata Abantis bicolor Anthene dulcis</span></span>
<span><span class="co">#&gt;      Dira swanepoeli swanepoeli Thaumetopoea apologetica Abantis pillaana Platylesches picanini</span></span>
<span><span class="co">#&gt;      Aethiopodes medioumbrata Chondrostegoides murina Trida barberae bunta Pseudomaenas margarita</span></span>
<span><span class="co">#&gt;      Chlorocoma didita Typhonia petrodes Conservula minor Lepidochrysops glauca Chrysoritis perseus</span></span>
<span><span class="co">#&gt;      Acontia psaliphora Gegenes pumilio Aloeides caffrariae Ludia goniata Scopula rossi</span></span>
<span><span class="co">#&gt;      Lamoria planalis Leucoplema dohertyi Lepidochrysops ortygia Helga cinerea Heliothis flavigera</span></span>
<span><span class="co">#&gt;      Durbaniella clarki Problepsis virginalis Scopula addictaria rufinubes Omphalestra mesomelana</span></span>
<span><span class="co">#&gt;      Allochlorodes elpis Chrysoritis pyroeis hersaleki Thestor protumnus protumnus</span></span>
<span><span class="co">#&gt;      Lophostethus Dumolinii Afrasura spec. Gelechiidae indet. Naarda spec. Chiasmia procidata</span></span>
<span><span class="co">#&gt;      Scopula sanguinisecta Metapioplasta gratiosa/transfigurata Aurivillius spec.</span></span>
<span><span class="co">#&gt;      Drepanogynis interscripta Isturgia spec. Lamoria spec. Lacipa spec. Heterocera indet.</span></span>
<span><span class="co">#&gt;      Chloroselas mazoensis Micragrotis puncticostata Tuxentius hesperis Angustalius casandra</span></span>
<span><span class="co">#&gt;      Charaxes jahlusa argynnides Pallastica pallens Autocharis sinualis Orachrysops violescens</span></span>
<span><span class="co">#&gt;      Dysodia crassa Metisella aegipan Orachrysops warreni Charaxes xiphares Zekelita coniodes</span></span>
<span><span class="co">#&gt;      Anthene liodes Micragrotis interstriata Dichomeris barathrodes Tegostoma florilegaria</span></span>
<span><span class="co">#&gt;      Charaxes castor Leptotes babaulti Salagena reticulata Belenois creona prorsus Dingana clara</span></span>
<span><span class="co">#&gt;      Dolosis illacerata Eudocima phalonia Mimoclystia tepescens Scopula punctilineata</span></span>
<span><span class="co">#&gt;      Achaea xanthoptera Borbo ferruginea Pseudozarba cupreofascia Platyptilia sabius Laelia batoides</span></span>
<span><span class="co">#&gt;      Platypepla persubtilis Deuterocopus socotranus Chrysoritis pan Trichophaga tapetzella</span></span>
<span><span class="co">#&gt;      Lophonotidia melanoleuca Charaxes karkloof trimeni Clepsis peritana Eulophonotus myrmeleon</span></span>
<span><span class="co">#&gt;      Neaspasia orthacta Paternympha loxophthalma Pterophorus pentadactyla Ozarba semipurpurea</span></span>
<span><span class="co">#&gt;      Thysanoplusia roseofasciata Antanartia schaeneia schaeneia Laelia Thalassodes opaca</span></span>
<span><span class="co">#&gt;      Patania balteata Amblyptilia direptalis Eublemma staudingeri Iolaus pallene Chrysodeixis acuta</span></span>
<span><span class="co">#&gt;      Bombycopsis bipars Estigmene multivittata Ectropis spoliataria Syngamia falsidicalis</span></span>
<span><span class="co">#&gt;      Aspilatopsis punctata Plusiodonta wahlbergi Phiala costipuncta Dysgonia erecta</span></span>
<span><span class="co">#&gt;      Eulycia subpunctata Aglossa incultalis Siccia melanospila Hypomecis ectropodes</span></span>
<span><span class="co">#&gt;      Carcinopodia argentata Acontia dispar Corgatha chionocraspis Anoba disjuncta</span></span>
<span><span class="co">#&gt;      Syngatha phoenicoxantha Grammarctia bilinea Ethmia rhomboidella Pseudonympha trimenii</span></span>
<span><span class="co">#&gt;      Idaea fumilinea fumilinea Micronola notonana Eretmocera fuscipennis Aroa anthora</span></span>
<span><span class="co">#&gt;      Mythimna viettei Spodoptera leucophlebia Thysanoplusia indicator Pingasa ruginaria communicans</span></span>
<span><span class="co">#&gt;      Doridostoma symplecta Amata khoisana khoisana Marmaroplegma paragarda Procrateria noloides</span></span>
<span><span class="co">#&gt;      Synanthedon ochracea Eulophonotus hyalinipennis Coenyra rufiplaga Leumicamia leucosoma</span></span>
<span><span class="co">#&gt;      Mythimna hamata Parortholitha nictitaria Spodoptera spec. Coenyra aurantiaca Chrysoritis whitei</span></span>
<span><span class="co">#&gt;      Typhonia circophora Kedestes lepenula Thestor dicksoni malagas Psycharium kammanassiense</span></span>
<span><span class="co">#&gt;      Chasmina tibialis Basiothia Lophoruza affulgens Neptis kiriakoffi Ozarba jansei Rhanidophora</span></span>
<span><span class="co">#&gt;      Racinoa Diaphone Aphnaeinae Chrysoritis zonarius coetzeri Aloeides pallida pallida</span></span>
<span><span class="co">#&gt;      Hypolamprus gangaba Phasis thero cedarbergae Lepidochrysops mcgregori Lepidochrysops praeterita</span></span>
<span><span class="co">#&gt;      Orygocera thysanarcha Eyralpenus diplosticta Jana transvaalica Aloeides clarki</span></span>
<span><span class="co">#&gt;      Kedestes lenis alba Drepanogynis legraini Pseudobazisa perculta Scyrotis athleta</span></span>
<span><span class="co">#&gt;      Sphingonaepiopsis ansorgei Iolaus diametra Zutulba namaqua Catephia natalensis Scopula opperta</span></span>
<span><span class="co">#&gt;      Rhanidophora spec. Homogyna ignivittata Cyana nemasisha Tsitana tulbagha tulbagha</span></span>
<span><span class="co">#&gt;      Chrysocraspeda leighata Monoplema fumigera Alucita phanerarcha Anticarsia rubricans</span></span>
<span><span class="co">#&gt;      Papilio constantinus constantinus Chrysoritis brooksi tearei Oraesia emarginata</span></span>
<span><span class="co">#&gt;      Nycterosea obstipata Hippotion aporodes Caffrocrambus angulilinea Hypolimnas anthedon anthedon</span></span>
<span><span class="co">#&gt;      Ancylolomia capensis Hypena holophaea Thelycera viridans Antanartia schaeneia</span></span>
<span><span class="co">#&gt;      Eudasychira metathermes Pingasa distensaria Xenimpia lactesignata Cymothoe alcimeda clarki</span></span>
<span><span class="co">#&gt;      Cnodontes penningtoni Polypogon typomelas Chiasma furcata Chabulina spec. Zelleria oleastrella</span></span>
<span><span class="co">#&gt;      Umkulunkula kalahariensis Scopula spec. Tortricidae indet. Lophoruza semiscripta</span></span>
<span><span class="co">#&gt;      Gonimbrasia cytherea Calliodes appollina Aloeides spec. Colotis danae Scopula pulchellata</span></span>
<span><span class="co">#&gt;      Sena donaldsoni Bicyclus safitza aethiops Chrysoritis zwartbergae zwartbergae</span></span>
<span><span class="co">#&gt;      Thysanoplusia chalcedona Aglossa phaealis Ephelis maesi Laelia municipalis</span></span>
<span><span class="co">#&gt;      Thysanoplusia spoliata Acridotarsa melipecta Bombyx mori Ornipholidotos peucetia penningtoni</span></span>
<span><span class="co">#&gt;      Homogyna xanthophora Lepidochrysops letsea Choreutis gratiosa Camaegeria sophax</span></span>
<span><span class="co">#&gt;      Chrysoritis aridus Endotricha consobrinalis Comostolopsis apicata Maxera zygia Pterophorinae</span></span>
<span><span class="co">#&gt;      Cabomina leucopleura Amauris ochlea subsp. ochlea Colotis indet. Eronia leda Anthene butleri</span></span>
<span><span class="co">#&gt;      Anaudia thyranthrena Hampsonata xaixaia Rhabdophera cortytoides Opogona dimidiatella</span></span>
<span><span class="co">#&gt;      Aedia squamosa Agriomelissa ursipes Mythimna corax Alonina luteopunctata Cabomina flavivertex</span></span>
<span><span class="co">#&gt;      Adicocrita discerpta Bombycopsis metallica Feliniopsis africana Plusiopalpa dichora Achaea</span></span>
<span><span class="co">#&gt;      Hypena saltalis Afrogegenes ocra Papilio ophidicephalus entabeni Chrysoritis nigricans</span></span>
<span><span class="co">#&gt;      Naarda flavisignata Pingasa rhadamaria alterata Eurystaura griseitincta griseitincta</span></span>
<span><span class="co">#&gt;      Cleora rothkirchi rothkirchi Syllepte glebalis Gymnoscelis oribiensis Plusiodonta achalcea</span></span>
<span><span class="co">#&gt;      Agrius convolvuli convolvuli Lepidochrysops littoralis Cyligramma magus Proconis abrostoloides</span></span>
<span><span class="co">#&gt;      Azygophleps cooksoni Orachrysops nasutus Alonina rufa Epicerura steniptera Chrysoritis endymion</span></span>
<span><span class="co">#&gt;      Ernsta depauperata australis Classeya argyrodonta Oiketicoides maledicta Isturgia pulinda</span></span>
<span><span class="co">#&gt;      Timora galatheae Agrotis spec. Scopariinae indet. Kalenga ansorgei Alucita spec.</span></span>
<span><span class="co">#&gt;      Crambidae indet. Araeopteron spec. Laeliopsis punctuligera Drepanogynis tripartita</span></span>
<span><span class="co">#&gt;      Hypena obacerralis Strigocossus capensis Drepanogynis epione Covelliana spec.</span></span>
<span><span class="co">#&gt;      Afroclanis calcareus Gegenes spec. Gonimbrasia wahlbergii Libythea labdaca laius</span></span>
<span><span class="co">#&gt;      Tildia acara acara Ceryx longipes Andronymus neander Melittia pyropis Vegetia ducalis</span></span>
<span><span class="co">#&gt;      Lophonotidia nocturna Nervia nerva nerva Bracharoa mixta Deudorix dinomenes</span></span>
<span><span class="co">#&gt;      Metachrostis rubripuncta Mauna filia Pierinae Panhyperochia ingens Clepsis spectrana</span></span>
<span><span class="co">#&gt;      Conchylia frosinaria Leptotes jeanneli Chrysoritis uranus schoemani</span></span>
<span><span class="co">#&gt;      Pseudonympha trimenii namaquana Aethiopodes stictoneura Phasis clavum subsp. erythema</span></span>
<span><span class="co">#&gt;      Gonoreta opacifinis Lepidochrysops balli Thestor protumnus Zekelita poecilopa</span></span>
<span><span class="co">#&gt;      Monopetalotaxis doleriformis Eicochrysops messapus subsp. messapus Feliniopsis indet.</span></span>
<span><span class="co">#&gt;      Odontocheilopteryx obscura Gegenes indet. Junonia orithya subsp. madagascariensis</span></span>
<span><span class="co">#&gt;      Colotis agoye subsp. bowkeri Palpita Paraproctis chionopeza Acraea aganice subsp. aganice</span></span>
<span><span class="co">#&gt;      Acraea encedon Amauris albimaculata subsp. albimaculata Belenois thysa subsp. thysa</span></span>
<span><span class="co">#&gt;      Dixeia indet. Eurema brigitta subsp. brigitta Eurema floricola subsp. floricola</span></span>
<span><span class="co">#&gt;      Leptosia alcesta subsp. inalcesta Phalanta phalantha subsp. aethiopica Acontia melaphora</span></span>
<span><span class="co">#&gt;      Pericyma polygramma Remigiodes remigina Chrysoritis pyroeis Bombycomorpha Appias</span></span>
<span><span class="co">#&gt;      Archichlora rectilineata Chrysoritis uranus Pseudonympha machacha Neita durbani</span></span>
<span><span class="co">#&gt;      Thestor penningtoni Aloeides susanae Pseudonympha poetula Tarsocera namaquensis</span></span>
<span><span class="co">#&gt;      Durbania amakosa natalensis Iolaus diametra natalica Homogyna sanguipennis Chrysotypus dawsoni</span></span>
<span><span class="co">#&gt;      Charaxes xiphares draconis Vanessa dimorphica dimorphica Jordaniana lactea Junonia stygia</span></span>
<span><span class="co">#&gt;      Junonia terea subsp. elgiva Laelia fracta Derriodes rufaria Hebdomophruda endroedyi</span></span>
<span><span class="co">#&gt;      Pseudomaenas prominens Taeda connexa Tarucus sybaris linearis Zamarada metrioscaphes</span></span>
<span><span class="co">#&gt;      Coenyropsis natalii poetulodes Zintha hintza krooni Chrysoritis swanepoeli swanepoeli</span></span>
<span><span class="co">#&gt;      Nassinia caffraria caffraria Stugeta bowkeri henningi Polyptychus grayii grayii</span></span>
<span><span class="co">#&gt;      Charaxes druceanus moerens Achaea oblita Gorgopis cochlias Ectochela dicksoni</span></span>
<span><span class="co">#&gt;      Afrogegenes hottentota Larentioides cacothemon Ceromitia natalensis Agriades orbitulus</span></span>
<span><span class="co">#&gt;      Thyas parallelipipeda Scopula obliquiscripta Junonia terea</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 5 rows ]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="generate-a-data-frame-xy-of-site-centroids">Generate a data frame ‘xy’ of site centroids<a class="anchor" aria-label="anchor" href="#generate-a-data-frame-xy-of-site-centroids"></a>
</h4>
<p>Extract longitude–latitude coordinates and summary metrics for each occupied grid cell.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grid centroids with 'gird_id', 'centroid_lon', 'centroid_lat', 'obs_sum' and `spp_rich`</span></span>
<span><span class="va">grid_xy</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create species observations data.frame</span></span>
<span><span class="va">spp_obs</span> <span class="op">=</span> <span class="va">site_obs</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">grid_xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 415   5</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grid_xy</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum spp_rich</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3        2</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41       31</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10       10</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7        7</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6        6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spp_obs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 79953     5</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spp_obs</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   site_id        x         y                            species value</span></span>
<span><span class="co">#&gt; 1       1 19.24410 -34.42086                   Pieris brassicae     1</span></span>
<span><span class="co">#&gt; 2       2 18.75564 -33.96044                   Pieris brassicae     1</span></span>
<span><span class="co">#&gt; 3       3 18.40321 -33.91651 Papilio demodocus subsp. demodocus     1</span></span>
<span><span class="co">#&gt; 4       1 19.24410 -34.42086 Mylothris agathina subsp. agathina     1</span></span>
<span><span class="co">#&gt; 5       4 18.47488 -34.35024                  Eutricha capensis     1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="generate-a-map-of-rsa-with-occupied-grid-cells-as-centroid-points">Generate a map of RSA with occupied grid cells as centroid points<a class="anchor" aria-label="anchor" href="#generate-a-map-of-rsa-with-occupied-grid-cells-as-centroid-points"></a>
</h4>
<p>Visualize observation density across South Africa using centroid-based mapping of gridded biodiversity data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aoi_grid</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">grid_spp</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">centroid_lon</span>, y <span class="op">=</span> <span class="va">centroid_lat</span>,</span>
<span>                 size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">obs_sum</span><span class="op">)</span>,</span>
<span>                 color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">obs_sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rsa</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"0.5° Grid with Observation Counts"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-map-aoi-1.png" width="100%"></p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="example-1---species-richness">Example 1 - Species Richness<a class="anchor" aria-label="anchor" href="#example-1---species-richness"></a>
</h3>
<p>Here we calculate species richness across sites in the block_sp dataset, again using the compute_orderwise function. The richness function is applied to the grid_id column for site identification, with species data specified by sp_cols. Orders 1 to 4 are computed i.e. for order=1, it computes basic species richness at individual sites, while higher orders (2 to 4) represent the differences in richness between pairwise and/or multi-site combinations. A subset of 1000 samples is used for higher-order computations to speed-up computation time. Parallel processing is enabled with 4 worker threads to improve performance. The output is a table summarizing species richness across specified orders.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute species richness (order 1) and the difference thereof for orders 2 to 4</span></span>
<span><span class="va">rich_o1234</span> <span class="op">=</span> <span class="fu"><a href="reference/compute_orderwise.html">compute_orderwise</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">grid_spp</span>,</span>
<span>  func <span class="op">=</span> <span class="va">richness</span>,</span>
<span>  site_col <span class="op">=</span> <span class="st">'grid_id'</span>,</span>
<span>  sp_cols <span class="op">=</span> <span class="va">sp_cols</span>,</span>
<span>  sample_no <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time elapsed for order 1: 0 minutes and 10.77 seconds</span></span>
<span><span class="co">#&gt; Time elapsed for order 2: 0 minutes and 19.26 seconds</span></span>
<span><span class="co">#&gt; Time elapsed for order 3: 1 minutes and 15.22 seconds</span></span>
<span><span class="co">#&gt; Time elapsed for order 4: 2 minutes and 46.79 seconds</span></span>
<span><span class="co">#&gt; Total computation time: 2 minutes and 46.80 seconds</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rich_o1234</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;    site_from site_to order value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      1026    &lt;NA&gt;     1     2</span></span>
<span><span class="co">#&gt; 2:      1027    &lt;NA&gt;     1    31</span></span>
<span><span class="co">#&gt; 3:      1028    &lt;NA&gt;     1    10</span></span>
<span><span class="co">#&gt; 4:      1029    &lt;NA&gt;     1     7</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot species richness distribution by order</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">order</span>,</span>
<span>        data <span class="op">=</span> <span class="va">rich_o1234</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#4575b4'</span>, <span class="st">'#99ce8f'</span>, <span class="st">'#fefab8'</span>, <span class="st">'#d73027'</span><span class="op">)</span>,</span>
<span>        horizontal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        main <span class="op">=</span> <span class="st">'Distribution of Species Richness by Order'</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-richness-plot-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Link centroid coordinates back to `rich_o1234` data.frame for plotting</span></span>
<span><span class="va">rich_o1234</span><span class="op">$</span><span class="va">centroid_lon</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">$</span><span class="va">centroid_lon</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">rich_o1234</span><span class="op">$</span><span class="va">site_from</span>, <span class="va">grid_spp</span><span class="op">$</span><span class="va">grid_id</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">rich_o1234</span><span class="op">$</span><span class="va">centroid_lat</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">$</span><span class="va">centroid_lat</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">rich_o1234</span><span class="op">$</span><span class="va">site_from</span>, <span class="va">grid_spp</span><span class="op">$</span><span class="va">grid_id</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Summarise turnover by site (spatial location)</span></span>
<span><span class="va">mean_rich_o1234</span> <span class="op">=</span> <span class="va">rich_o1234</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">order</span>, <span class="va">site_from</span>, <span class="va">centroid_lon</span>, <span class="va">centroid_lat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mean_rich_o1234</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 5</span></span>
<span><span class="co">#&gt; # Groups:   order, site_from, centroid_lon [4]</span></span>
<span><span class="co">#&gt;   order site_from centroid_lon centroid_lat value</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1 1026              28.8        -22.3     2</span></span>
<span><span class="co">#&gt; 2     1 1027              29.2        -22.3    31</span></span>
<span><span class="co">#&gt; 3     1 1028              29.7        -22.3    10</span></span>
<span><span class="co">#&gt; 4     1 1029              30.3        -22.3     7</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="example-2---community-turnover">Example 2 - Community Turnover<a class="anchor" aria-label="anchor" href="#example-2---community-turnover"></a>
</h3>
<p>Here we calculate species turnover (beta diversity) across sites in the block_sp dataset using the compute_orderwise function again. The turnover function is applied to the grid_id column for site identification, with species data specified by sp_cols. Order = 1 is not an option because turnover requires a comparison between sites. For orders 2 to 5, it computes turnover for pairwise and higher-order site combinations, representing the proportion of species not shared between sites. A subset of 1000 samples is used for higher-order comparisons. Parallel processing with 4 worker threads improves efficiency, and the output is a table summarizing species turnover across the specified orders.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute community turnover for orders 2 to 5</span></span>
<span><span class="va">turn_o2345</span> <span class="op">=</span> <span class="fu"><a href="reference/compute_orderwise.html">compute_orderwise</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">grid_spp</span>,</span>
<span>  func <span class="op">=</span> <span class="va">turnover</span>,</span>
<span>  site_col <span class="op">=</span> <span class="st">'grid_id'</span>,</span>
<span>  sp_cols <span class="op">=</span> <span class="va">sp_cols</span>, <span class="co"># OR `names(grid_spp)[-c(1:4)]`</span></span>
<span>  sample_no <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Reduce to speed-up computation</span></span>
<span>  order <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time elapsed for order 2: 0 minutes and 17.51 seconds</span></span>
<span><span class="co">#&gt; Time elapsed for order 3: 1 minutes and 30.79 seconds</span></span>
<span><span class="co">#&gt; Time elapsed for order 4: 3 minutes and 9.62 seconds</span></span>
<span><span class="co">#&gt; Time elapsed for order 5: 5 minutes and 3.95 seconds</span></span>
<span><span class="co">#&gt; Total computation time: 5 minutes and 3.96 seconds</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">turn_o2345</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;    site_from site_to order     value</span></span>
<span><span class="co">#&gt;       &lt;char&gt;  &lt;char&gt; &lt;int&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      1027    1026     2 0.9354839</span></span>
<span><span class="co">#&gt; 2:      1028    1026     2 0.9090909</span></span>
<span><span class="co">#&gt; 3:      1029    1026     2 1.0000000</span></span>
<span><span class="co">#&gt; 4:      1030    1026     2 1.0000000</span></span></code></pre></div>
<p>To visualize the spatial patterns of turnover across sites, geographic coordinates are added back to the results. This allows spatial exploration of turnover patterns across different orders, highlighting regions of high or low turnover and enabling comparisons across orders. These visualizations provide valuable insights into spatial biodiversity dynamics. Below we assign the geographic coordinates (x and y) from the block_sp dataset to the turn_o2345 results. Using match, it aligns the coordinates to the site_from column in turn_o2345 based on the corresponding grid_id values in block_sp. This prepares the dataset for spatial plotting.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add coordinates back to 'turn_o2345' for plotting</span></span>
<span><span class="va">turn_o2345</span><span class="op">$</span><span class="va">centroid_lon</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">$</span><span class="va">centroid_lon</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">turn_o2345</span><span class="op">$</span><span class="va">site_from</span>, <span class="va">grid_spp</span><span class="op">$</span><span class="va">grid_id</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">turn_o2345</span><span class="op">$</span><span class="va">centroid_lat</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">$</span><span class="va">centroid_lat</span><span class="op">[</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">turn_o2345</span><span class="op">$</span><span class="va">site_from</span>, <span class="va">grid_spp</span><span class="op">$</span><span class="va">grid_id</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Summarise turnover by site (spatial location)</span></span>
<span><span class="va">mean_turn_o2345</span> <span class="op">=</span> <span class="va">turn_o2345</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">order</span>, <span class="va">site_from</span>, <span class="va">centroid_lon</span>, <span class="va">centroid_lat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Beta Diversity (pairwise turnover i.e. only order 2) calculated using `compute_orderwise(..., func = turnover, ...)`</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_turn_o2345</span><span class="op">[</span><span class="va">mean_turn_o2345</span><span class="op">$</span><span class="va">order</span><span class="op">==</span><span class="fl">2</span>,<span class="op">]</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">centroid_lon</span>, y <span class="op">=</span> <span class="va">centroid_lat</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#Apply viridis color palette</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rsa</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>, fill <span class="op">=</span> <span class="st">"Beta Diversity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-turnover-plot-order2-1.png" width="100%"></p>
<p>Plot order-wise turnover (orders 2:5) calculated using <code>compute_orderwise(..., func = turnover, ...)</code> to visualise spatial patterns of turnover across different orders. Results highlight regions of high or low turnover and facilitate comparison across orders, providing insights into spatial biodiversity dynamics.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot order-wise turnover (orders 2:5) calculated using `compute_orderwise(..., func = turnover, ...)`</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_turn_o2345</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">centroid_lon</span>, y <span class="op">=</span> <span class="va">centroid_lat</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span>, name <span class="op">=</span> <span class="st">"Turnover"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rsa</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Mean Turnover by Order"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Latitude"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">order</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-turnover-plot-orders2345-1.png" width="100%"></p>
<hr>
</div>
<div class="section level3">
<h3 id="id_7-generate-site-by-species-matrix---site_spp">7. Generate site by species matrix - <code>site_spp</code>
<a class="anchor" aria-label="anchor" href="#id_7-generate-site-by-species-matrix---site_spp"></a>
</h3>
<p>Create a matrix of species counts per site for use in biodiversity and dissimilarity analyses.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">site_spp</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">grid_spp</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 415   2</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="co">#&gt;   centroid_lon centroid_lat</span></span>
<span><span class="co">#&gt; 1        28.75    -22.25004</span></span>
<span><span class="co">#&gt; 2        29.25    -22.25004</span></span>
<span><span class="co">#&gt; 3        29.75    -22.25004</span></span>
<span><span class="co">#&gt; 4        30.25    -22.25004</span></span>
<span><span class="co">#&gt; 5        30.75    -22.25004</span></span>
<span><span class="co">#&gt; 6        31.25    -22.25004</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">site_spp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  415 2873</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">site_spp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum spp_rich Mylothris agathina subsp. agathina</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3        2                                  0</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41       31                                  0</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10       10                                  0</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7        7                                  0</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6        6                                  0</span></span>
<span><span class="co">#&gt; 6    1031        31.25    -22.25004     107       76                                  0</span></span></code></pre></div>
<div class="section level4">
<h4 id="fetch-record-of-occurrence-counts-calculated-using-generate_grid">Fetch record of occurrence counts calculated using <code>generate_grid</code>
<a class="anchor" aria-label="anchor" href="#fetch-record-of-occurrence-counts-calculated-using-generate_grid"></a>
</h4>
<p><code>generate_grid</code> summarised the number of species observations per grid cell to assess sampling effort.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sampling effort = observation counts</span></span>
<span><span class="va">sam_eff</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grid_id"</span>,<span class="st">"centroid_lon"</span>,<span class="st">"centroid_lat"</span>,<span class="st">"obs_sum"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">obs_cnt</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">obs_cnt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 415   4</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">obs_cnt</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6</span></span>
<span><span class="co">#&gt; 6    1031        31.25    -22.25004     107</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="generate-a-binary-presenceabsence-data-frame-sbs">Generate a binary (presence/absence) data frame ‘sbs’<a class="anchor" aria-label="anchor" href="#generate-a-binary-presenceabsence-data-frame-sbs"></a>
</h4>
<p>Convert species abundance data to presence/absence format (<code>site_spp_pa</code>) for binary dissimilarity analyses.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create site-by-species matrix</span></span>
<span><span class="va">sbs</span> <span class="op">=</span> <span class="va">site_spp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">sp_cols</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  415 2873</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum spp_rich Mylothris agathina subsp. agathina</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3        2                                  0</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41       31                                  0</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10       10                                  0</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7        7                                  0</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6        6                                  0</span></span>
<span><span class="co">#&gt; 6    1031        31.25    -22.25004     107       76                                  0</span></span>
<span></span>
<span><span class="co"># Assuming 'sp_cols' is a vector of column names</span></span>
<span><span class="va">site_spp_pa</span> <span class="op">=</span> <span class="va">site_spp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">sp_cols</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">.</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  415 2873</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum spp_rich Mylothris agathina subsp. agathina</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3        2                                  0</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41       31                                  0</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10       10                                  0</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7        7                                  0</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6        6                                  0</span></span>
<span><span class="co">#&gt; 6    1031        31.25    -22.25004     107       76                                  0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fetch-species-richness-values-calculated-using-generate_grid">Fetch species richness values calculated using <code>generate_grid</code>
<a class="anchor" aria-label="anchor" href="#fetch-species-richness-values-calculated-using-generate_grid"></a>
</h4>
<p><code>generate_grid</code> calculated species richness per site based on binary presence/absence records.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species richness</span></span>
<span><span class="va">spp_rich</span> <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grid_id"</span>,<span class="st">"centroid_lon"</span>,<span class="st">"centroid_lat"</span>,<span class="st">"spp_rich"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  415 2873</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum spp_rich Mylothris agathina subsp. agathina</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3        2                                  0</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41       31                                  0</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10       10                                  0</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7        7                                  0</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6        6                                  0</span></span>
<span><span class="co">#&gt; 6    1031        31.25    -22.25004     107       76                                  0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="generate-obs_cnt-and-spp_rich-raster-maps">Generate ‘obs_cnt’ and ‘spp_rich’ raster maps<a class="anchor" aria-label="anchor" href="#generate-obs_cnt-and-spp_rich-raster-maps"></a>
</h4>
<p><code>generate_grid</code> also creates a <code>SpatRast</code> to help visualise sampling effort and species richness over the study area.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species richness and sampling effort SpatRast</span></span>
<span><span class="va">ras_effRich</span> <span class="op">=</span> <span class="va">grid_list</span><span class="op">$</span><span class="va">grid</span><span class="op">[[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Plot `ras_effRich` using colour palettes from `viridis`</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">ras_effRich</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">turbo</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-eff-rich-1.png" width="100%"></p>
<p><em><strong>Note</strong>: occurrence coordinates are only used for assigning then into grids; they are not needed beyond this step.</em></p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="id_8-generate-site-by-environment-matrix-using-get_enviro_data">8. Generate site by environment matrix using <code>get_enviro_data</code>
<a class="anchor" aria-label="anchor" href="#id_8-generate-site-by-environment-matrix-using-get_enviro_data"></a>
</h3>
<p>Use <code>get_enviro_data</code> to extract environmental variables for spatial points from either species observations or grid centroids. Data can be sourced from online repositories (e.g. <em>WorldClim</em>, <em>SoilGrids</em> via <code>geodata</code>) or local rasters. The function defines an area of interest with a buffer, extracts selected variables, and interpolates missing values using nearby non-NA points. Outputs include cropped rasters, spatial points (as an <code>sf</code> object), and a combined site-by-environment data frame (<code>site_env</code>) for downstream ecological analyses. Future support will extend to <em>CHELSA</em> (<code>climenv</code>), <em>Google Earth Engine</em> (<code>rgee</code>), and <code>mapme.biodiversity</code> for expanded environmental and biodiversity data access.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use `get_enviro_data` to fetch environmental data for your grid centroids</span></span>
<span><span class="va">enviro_list</span> <span class="op">=</span> <span class="fu"><a href="reference/get_enviro_data.html">get_enviro_data</a></span><span class="op">(</span></span>
<span>  data      <span class="op">=</span> <span class="va">sbs</span>,</span>
<span>  buffer_km <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  source    <span class="op">=</span> <span class="st">'geodata'</span>,</span>
<span>  var       <span class="op">=</span> <span class="st">"bio"</span>,</span>
<span>  res       <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  path      <span class="op">=</span> <span class="st">'download_data'</span>,</span>
<span>  sp_cols   <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">)</span>,</span>
<span>  ext_cols  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'obs_sum'</span>,<span class="st">'spp_rich'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: Create new objects from list items</span></span>
<span><span class="va">ras_enviro</span> <span class="op">=</span> <span class="va">enviro_list</span><span class="op">$</span><span class="va">env_rast</span></span>
<span></span>
<span><span class="co"># Optional: Rename the columns to something more descriptive</span></span>
<span><span class="va">names_env</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temp_mean"</span>, <span class="st">"mdr"</span>, <span class="st">"iso"</span>, <span class="st">"temp_sea"</span>, <span class="st">"temp_max"</span>,</span>
<span>                    <span class="st">"temp_min"</span>, <span class="st">"temp_rang"</span>,<span class="st">"temp_wetQ"</span>,<span class="st">"temp_dryQ"</span>, <span class="st">"temp_warmQ"</span>,</span>
<span>                    <span class="st">"temp_coldQ"</span>, <span class="st">"rain_mean"</span>,<span class="st">"rain_wet"</span>, <span class="st">"rain_dry"</span>, <span class="st">"rain_sea"</span>,</span>
<span>                    <span class="st">"rain_wetQ"</span>, <span class="st">"rain_dryQ"</span>,<span class="st">"rain_warmQ"</span>, <span class="st">"rain_coldQ"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">enviro_list</span><span class="op">$</span><span class="va">env_rast</span><span class="op">)</span> <span class="op">=</span> <span class="va">names_env</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ras_enviro</span><span class="op">)</span> <span class="op">=</span> <span class="va">names_env</span></span></code></pre></div>
<div class="section level4">
<h4 id="add-eff-rich-raster-to-the-enviro-stack-raster">Add ‘eff-rich’ raster to the enviro stack raster<a class="anchor" aria-label="anchor" href="#add-eff-rich-raster-to-the-enviro-stack-raster"></a>
</h4>
<p>Combine environmental rasters with sampling effort and species richness layers for joint spatial analysis.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine `SpatRast`</span></span>
<span><span class="va">ras_enviro_effRich</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ras_effRich</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/resample.html" class="external-link">resample</a></span><span class="op">(</span><span class="va">ras_enviro</span>, <span class="va">ras_effRich</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the first 4 layers of `ras_enviro_effRich`</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ras_enviro_effRich</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-ras-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="create-dataframe-of-environmental-variables-with-site-centroids-xy">Create data.frame of environmental variables with site centroids ‘xy’<a class="anchor" aria-label="anchor" href="#create-dataframe-of-environmental-variables-with-site-centroids-xy"></a>
</h4>
<p>Environmental data were linked to grid centroids using <code>get_enviro_data</code>, now visualise the spatial variation in selected climate variables to check results.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create `env_df`</span></span>
<span><span class="va">env_df</span> <span class="op">=</span> <span class="va">enviro_list</span><span class="op">$</span><span class="va">env_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">:</span><span class="fl">26</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Make sure column names are correct</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">env_df</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grid_id"</span>,<span class="st">"centroid_lon"</span>,<span class="st">"centroid_lat"</span>,<span class="st">"obs_sum"</span>,<span class="st">"spp_rich"</span>,<span class="st">"temp_mean"</span>,</span>
<span>                  <span class="st">"mdr"</span>, <span class="st">"iso"</span>, <span class="st">"temp_sea"</span>, <span class="st">"temp_max"</span>,</span>
<span>                    <span class="st">"temp_min"</span>, <span class="st">"temp_rang"</span>,<span class="st">"temp_wetQ"</span>,<span class="st">"temp_dryQ"</span>, <span class="st">"temp_warmQ"</span>,</span>
<span>                    <span class="st">"temp_coldQ"</span>, <span class="st">"rain_mean"</span>,<span class="st">"rain_wet"</span>, <span class="st">"rain_dry"</span>, <span class="st">"rain_sea"</span>,</span>
<span>                    <span class="st">"rain_wetQ"</span>, <span class="st">"rain_dryQ"</span>,<span class="st">"rain_warmQ"</span>, <span class="st">"rain_coldQ"</span><span class="op">)</span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">env_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 415  24</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">env_df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   grid_id centroid_lon centroid_lat obs_sum spp_rich temp_mean</span></span>
<span><span class="co">#&gt; 1    1026        28.75    -22.25004       3        2  21.88425</span></span>
<span><span class="co">#&gt; 2    1027        29.25    -22.25004      41       31  21.76921</span></span>
<span><span class="co">#&gt; 3    1028        29.75    -22.25004      10       10  21.53492</span></span>
<span><span class="co">#&gt; 4    1029        30.25    -22.25004       7        7  23.01796</span></span>
<span><span class="co">#&gt; 5    1030        30.75    -22.25004       6        6  23.59879</span></span>
<span><span class="co">#&gt; 6    1031        31.25    -22.25004     107       76  24.57367</span></span>
<span></span>
<span><span class="co"># Plot the results to check the conversion is accurate</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add 0.25deg grid layer</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">aoi_grid</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add bfly points layer</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">env_df</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">centroid_lon</span>,</span>
<span>                 y <span class="op">=</span> <span class="va">centroid_lat</span>,</span>
<span>                 size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">temp_mean</span><span class="op">)</span>,</span>
<span>                 color <span class="op">=</span> <span class="va">temp_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Use turbo color scale</span></span>
<span>  <span class="co"># Add boundary layer</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rsa</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"0.5° Grid Cells with temp_mean"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span>   </span></code></pre></div>
<p><img src="reference/figures/README-env-df-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="generate-site-by-environment-data-frame-sbe">Generate <em>Site-by-Environment</em> data frame ‘sbe’<a class="anchor" aria-label="anchor" href="#generate-site-by-environment-data-frame-sbe"></a>
</h4>
<p>Create a unified data frame of site coordinates, sampling effort, richness, and environmental variables for modelling called <code>sbe</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create `sbe` data.frame</span></span>
<span><span class="va">sbe</span> <span class="op">=</span> <span class="va">env_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">grid_id</span>, <span class="va">centroid_lon</span>, <span class="va">centroid_lat</span>, <span class="va">obs_sum</span>, <span class="va">spp_rich</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_9-change-coordinates-projection-using-sfst_transform">9. Change coordinates projection using <code>sf::st_transform</code>
<a class="anchor" aria-label="anchor" href="#id_9-change-coordinates-projection-using-sfst_transform"></a>
</h3>
<p>Reproject spatial coordinates from geographic (WGS84) to a projected system (e.g. Albers Equal Area) for analyses requiring distance in meters, such as spatial clustering or environmental modelling.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to sf object with WGS84 geographic CRS</span></span>
<span><span class="va">xy_sf</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">xy</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"centroid_lon"</span>, <span class="st">"centroid_lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Project to Albers Equal Area (meters)</span></span>
<span><span class="va">xy_utm</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">xy_sf</span>, crs <span class="op">=</span> <span class="fl">9822</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract transformed coordinates in meters</span></span>
<span><span class="co"># Combine transformed coordinates back into data frame</span></span>
<span><span class="va">xy_utm_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">xy</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">xy_utm</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check results and compare coordinate formats</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="co">#&gt;   centroid_lon centroid_lat</span></span>
<span><span class="co">#&gt; 1        28.75    -22.25004</span></span>
<span><span class="co">#&gt; 2        29.25    -22.25004</span></span>
<span><span class="co">#&gt; 3        29.75    -22.25004</span></span>
<span><span class="co">#&gt; 4        30.25    -22.25004</span></span>
<span><span class="co">#&gt; 5        30.75    -22.25004</span></span>
<span><span class="co">#&gt; 6        31.25    -22.25004</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xy_utm_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   centroid_lon centroid_lat       X        Y</span></span>
<span><span class="co">#&gt; 1        28.75    -22.25004 6392274 -6836200</span></span>
<span><span class="co">#&gt; 2        29.25    -22.25004 6480542 -6808542</span></span>
<span><span class="co">#&gt; 3        29.75    -22.25004 6568648 -6780369</span></span>
<span><span class="co">#&gt; 4        30.25    -22.25004 6656587 -6751682</span></span>
<span><span class="co">#&gt; 5        30.75    -22.25004 6744357 -6722482</span></span>
<span><span class="co">#&gt; 6        31.25    -22.25004 6831955 -6692770</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="id_10-check-for-colinearity-using-rm_correlated">10. Check for colinearity using <code>rm_correlated</code>
<a class="anchor" aria-label="anchor" href="#id_10-check-for-colinearity-using-rm_correlated"></a>
</h3>
<p>Identify and remove highly correlated environmental variables to reduce multicollinearity in subsequent analyses. This step ensures model stability by retaining only informative, non-redundant predictors based on a user-defined correlation threshold.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove the highly correlated variables</span></span>
<span><span class="va">env_vars_reduced</span> <span class="op">=</span> <span class="fu"><a href="reference/rm_correlated.html">rm_correlated</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">env_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                 cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                 threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                                 plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-remove_var-1.png" width="100%"></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co">#&gt; Variables removed due to high correlation:</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="co">#&gt;  [1] "temp_rang"  "temp_sea"   "mdr"        "temp_max"   "rain_mean"  "rain_dryQ"  "temp_min"  </span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co">#&gt;  [8] "temp_warmQ" "temp_coldQ" "rain_coldQ" "rain_wetQ"  "rain_wet"   "rain_sea"  </span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co">#&gt; Variables retained:</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#&gt; [1] "obs_sum"    "temp_mean"  "iso"        "temp_wetQ"  "temp_dryQ"  "rain_dry"   "rain_warmQ"</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="co"># Compare numbers of environmental variables</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="fu">ncol</span>(env_df[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">24</span>)])</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="co">#&gt; [1] 20</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="fu">ncol</span>(env_vars_reduced)</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="id_11-calculate-zeta-decline-for-orders-215">11. Calculate Zeta decline for orders 2:15<a class="anchor" aria-label="anchor" href="#id_11-calculate-zeta-decline-for-orders-215"></a>
</h3>
<div class="section level4">
<h4 id="expectation-of-zeta-diversity-decline-using-zetadivzetadeclineex">Expectation of zeta diversity decline using <code>zetadiv::Zeta.decline.ex</code>
<a class="anchor" aria-label="anchor" href="#expectation-of-zeta-diversity-decline-using-zetadivzetadeclineex"></a>
</h4>
<p>Computes the expectation of zeta diversity, the number of species shared by multiple assemblages for a range of orders (number of assemblages or sites), using a formula based on the occupancy of the species, and fits the decline to an exponential and a power law relationship. <em>Generate statistics and figures, no maps</em></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeta_decline_ex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zetadiv/man/Zeta.decline.ex.html" class="external-link">Zeta.decline.ex</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">[</span>,<span class="fl">6</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                                  orders <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-zeta-decline-ex-1.png" width="100%"></p>
<blockquote>
<ul>
<li>
<strong>Panel 1 (Zeta diversity decline)</strong>: Shows how rapidly species that are common across multiple sites decline as you look at groups of more and more sites simultaneously (increasing zeta order). The sharp drop means fewer species are shared among many sites compared to just a few.</li>
<li>
<strong>Panel 2 (Ratio of zeta diversity decline)</strong>: Illustrates the proportion of shared species that remain as the number of sites compared increases. A steeper curve indicates that common species quickly become rare across multiple sites.</li>
<li>
<strong>Panel 3 (Exponential regression)</strong>: Tests if the decline in shared species fits an exponential decrease. A straight line here indicates that species commonness decreases rapidly and consistently as more sites are considered together. Exponential regression represents <u><strong>stochastic assembly</strong></u> (<strong>randomness determining species distributions</strong>).</li>
<li>
<strong>Panel 4 (Power law regression)</strong>: Tests if the decline follows a power law relationship. A straight line suggests that the loss of common species follows a predictable pattern, where initially many species are shared among fewer sites, but rapidly fewer are shared among larger groups. Power law regression represents <u><strong>niche-based sorting</strong></u> (<strong>environmental factors shaping species distributions</strong>).</li>
</ul>
</blockquote>
<blockquote>
<p><strong>Interpretation</strong>: The near‐perfect straight line in the exponential panel (high R²) indicates that an exponential model provides the most parsimonious description of how species shared across sites decline as you add more sites—consistent with a stochastic, memory-less decline in common species. A power law will also fit in broad strokes, but deviates at high orders, suggesting exponential decay is the better choice for these data.</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="zeta-diversity-decline-using-monte-carlo-sampling-zetadivzetadeclinemc">Zeta diversity decline using Monte Carlo sampling <code>zetadiv::Zeta.decline.mc</code>
<a class="anchor" aria-label="anchor" href="#zeta-diversity-decline-using-monte-carlo-sampling-zetadivzetadeclinemc"></a>
</h4>
<p>Computes zeta diversity, the number of species shared by multiple assemblages, for a range of orders (number of assemblages or sites), using combinations of sampled sites, and fits the decline to an exponential and a power law relationship. <em>Generate statistics and figures, no maps</em></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeta_mc_utm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zetadiv/man/Zeta.decline.mc.html" class="external-link">Zeta.decline.mc</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                               <span class="va">xy_utm_df</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>                               orders <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,</span>
<span>                               sam <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                               NON <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                               normalize <span class="op">=</span> <span class="st">"Jaccard"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-zeta-decline-mc-1.png" width="100%"></p>
<blockquote>
<ul>
<li>
<strong>Panel 1 (Zeta diversity decline)</strong>: Rapidly declining zeta diversity, similar to previous plots, indicates very few species remain shared across increasingly larger sets of sites, emphasizing strong species turnover and spatial specialization.</li>
<li>
<strong>Panel 2 (Ratio of zeta diversity decline)</strong>: More irregular fluctuations suggest a spatial effect: nearby sites might occasionally share more species by chance due to proximity. The spikes mean certain groups of neighboring sites have higher-than-average species overlap.</li>
<li>
<strong>Panel 3 &amp; 4 (Exponential and Power law regressions)</strong>: Both remain linear, clearly indicating the zeta diversity declines consistently following a predictable spatial pattern. However, the exact pattern remains similar to previous cases, highlighting that despite spatial constraints, common species become rare quickly as more sites are considered.<br><em>This result demonstrates clear spatial structuring of biodiversity—species are locally clustered, not randomly distributed across the landscape. Spatial proximity influences which species co-occur more frequently. In practice use <code>Zeta.decline.mc</code> for real‐world biodiversity data—both because it scales and because the Monte Carlo envelope is invaluable when ζₖ gets noisier at higher orders.</em>
</li>
</ul>
</blockquote>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="id_12-calculate-zeta-decay-for-orders-28">12. Calculate Zeta decay for orders 2:8<a class="anchor" aria-label="anchor" href="#id_12-calculate-zeta-decay-for-orders-28"></a>
</h3>
<div class="section level4">
<h4 id="zeta-distance-decay-for-a-range-of-numbers-of-assemblages-or-sites-using-zetadivzetaddecays">Zeta distance decay for a range of numbers of assemblages or sites using <code>zetadiv::Zeta.ddecays</code>
<a class="anchor" aria-label="anchor" href="#zeta-distance-decay-for-a-range-of-numbers-of-assemblages-or-sites-using-zetadivzetaddecays"></a>
</h4>
<p>Computes the distance decay of zeta diversity for a range of orders (number of assemblages or sites), using generalised linear models. <em>Generate statistics and figures, no maps</em></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate Zeta.ddecays</span></span>
<span><span class="va">zeta_decays</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zetadiv/man/Zeta.ddecays.html" class="external-link">Zeta.ddecays</a></span><span class="op">(</span><span class="va">xy_utm_df</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>                          <span class="va">site_spp_pa</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                          sam <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                          orders <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>,</span>
<span>                          plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          confint.level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; [1] 8</span></span></code></pre></div>
<p><img src="reference/figures/README-zeta-decays-1.png" width="100%"></p>
<blockquote>
<p>This plot shows how zeta diversity (a metric that captures shared species composition among multiple sites) changes with spatial distance across different orders of zeta (i.e., the number of sites considered at once).</p>
</blockquote>
<blockquote>
<ul>
<li>On the <strong>x-axis</strong>, we have the <strong>order of zeta</strong> (from 2 to 7).<br>
For example, zeta order 2 looks at pairs of sites, order 3 at triplets, etc.</li>
<li>On the <strong>y-axis</strong>, we see the slope of the <strong>relationship between zeta diversity and distance</strong> (i.e., how quickly species similarity declines with distance).</li>
<li>A <strong>negative slope</strong> means that <strong>sites farther apart have fewer species in common</strong> — so there’s a clear distance decay of biodiversity.</li>
<li>A <strong>slope near zero</strong> means <strong>distance doesn’t strongly affect how many species are shared among sites</strong>.</li>
</ul>
</blockquote>
<blockquote>
<p><strong>Key observations:</strong> - At low orders (2 and 3), the slope is strongly negative, indicating that species turnover is high over distance when looking at pairs or triplets of sites. - From order 4 and up, the slope becomes close to zero, suggesting that at broader spatial scales (more sites), species similarity is less affected by distance.<br>
This may reflect widespread or core species that are consistently shared regardless of location. - The confidence intervals (error bars) shrink with increasing order, indicating greater stability and reliability of the estimate as more sites are included.</p>
</blockquote>
<blockquote>
<p><strong>Summary:</strong> This figure shows that biodiversity patterns across space are strongly shaped by distance at small scales, but this effect weakens as you include more sites. In other words, rare or localized species contribute to strong distance decay, but widespread species dominate at higher spatial scales, leading to more uniformity. <em>Species that occur in just two or three sites show a clear “farther apart → fewer shared species” pattern. But when you ask about the handful of really widespread species (those present in four, five, or more sites), their shared‐species counts no longer decline with distance—they form a spatially uniform core.</em></p>
</blockquote>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="id_13-run-a-multi-site-generalised-dissimilarity-model-for-order-2">13. Run a Multi-Site Generalised Dissimilarity Model for order 2<a class="anchor" aria-label="anchor" href="#id_13-run-a-multi-site-generalised-dissimilarity-model-for-order-2"></a>
</h3>
<div class="section level4">
<h4 id="multi-site-generalised-dissimilarity-modelling-for-a-set-of-environmental-variables-and-distances-using-zetadivzetamsgdm">Multi-site generalised dissimilarity modelling for a set of environmental variables and distances using <code>zetadiv::Zeta.msgdm</code>
<a class="anchor" aria-label="anchor" href="#multi-site-generalised-dissimilarity-modelling-for-a-set-of-environmental-variables-and-distances-using-zetadivzetamsgdm"></a>
</h4>
<p>Computes a regression model of zeta diversity for a given order (number of assemblages or sites) against a set of environmental variables and distances between sites. The different regression models available are generalised linear models, generalised linear models with negative constraints, generalised additive models, shape constrained additive models, and I-splines. <em>Generate statistics and figures, no maps and save fitted order 2 model ‘zeta2’</em></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute a regression model of zeta diversity order 2</span></span>
<span><span class="va">zeta2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zetadiv/man/Zeta.msgdm.html" class="external-link">Zeta.msgdm</a></span><span class="op">(</span><span class="va">site_spp_pa</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                   <span class="va">env_vars_reduced</span><span class="op">[</span>,<span class="op">-</span><span class="fl">8</span><span class="op">]</span>,</span>
<span>                   <span class="co"># xy_utm_df[,3:4],</span></span>
<span>                   <span class="va">xy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                   sam <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                   order <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                   distance.type <span class="op">=</span> <span class="st">"Euclidean"</span>,<span class="co"># "ortho",</span></span>
<span>                   normalize <span class="op">=</span> <span class="st">"Jaccard"</span>,</span>
<span>                   reg.type <span class="op">=</span> <span class="st">"ispline"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute splines coordinates from I-spline-based MSGDM</span></span>
<span><span class="va">zeta2.ispline</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zetadiv/man/Return.ispline.html" class="external-link">Return.ispline</a></span><span class="op">(</span><span class="va">zeta2</span>,</span>
<span>                               <span class="va">env_vars_reduced</span><span class="op">[</span>,<span class="op">-</span><span class="fl">8</span><span class="op">]</span>,</span>
<span>                               <span class="co"># legend = FALSE,</span></span>
<span>                               distance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># zeta2.ispline</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/zetadiv/man/Plot.ispline.html" class="external-link">Plot.ispline</a></span><span class="op">(</span>isplines <span class="op">=</span> <span class="va">zeta2.ispline</span>, distance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-zeta-msgdm-1.png" width="100%"></p>
<blockquote>
<p>This figure shows the fitted I-splines from a multi-site generalized dissimilarity model (via <code>Zeta.msgdm</code>), which represent the partial, monotonic relationship between each predictor and community turnover (ζ-diversity) over its 0–1 “rescaled” range. A few key take-aways:</p>
</blockquote>
<blockquote>
<ol style="list-style-type: decimal">
<li>
<strong>Distance (blue asterisks)</strong> has by far the largest I-spline amplitude—rising from ~0 at zero distance to ~0.05 at the maximum. That tells us spatial separation is the strongest driver of multi‐site turnover, and even small increases in distance yield a substantial drop in shared species.</li>
<li>
<strong>Sampling intensity (<code>obs_sum</code>, open circles)</strong> comes next, with a gentle but steady rise to ~0.045. This indicates that sites with more observations tend to share more species (or, conversely, that incomplete sampling can depress apparent turnover).</li>
<li>
<strong>Precipitation variables</strong>: <strong>Rain in the warm quarter (<code>rain_warmQ</code>, squares)</strong> and <strong>Rain in the dry quarter (<code>rain_dry</code>, triangles-down)</strong> both show moderate effects (I-spline heights ~0.02–0.03). This means differences in seasonal rainfall regimes contribute noticeably to changes in community composition.</li>
<li>
<strong>Temperature metrics</strong>: <strong>Mean temperature</strong> <em>(<code>temp_mean</code>, triangles-up)</em>, <strong>Wet‐quarter temperature</strong> <em>(<code>temp_wetQ</code>, X’s)</em>, <strong>Dry‐quarter temperature</strong> <em>(<code>temp_dryQ</code>, diamonds)</em>, and the <strong>isothermality index</strong> <em>(<code>iso</code>, plus signs)</em> all have very low, almost flat I-splines (max heights ≲0.01). In other words, these thermal variables explain very little additional turnover once you’ve accounted for distance and rainfall.</li>
</ol>
</blockquote>
<blockquote>
<p><strong>Ecological interpretation:</strong> Spatial distance is the dominant structuring factor in these data—sites further apart share markedly fewer species. After accounting for that, differences in observation effort and, to a lesser degree, seasonal rainfall still shape multisite community similarity. Temperature and seasonality metrics, by contrast, appear to have only a minor independent influence on zeta‐diversity in this landscape.</p>
</blockquote>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Deviance explained summary results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeta2</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">deviance</span><span class="op">/</span><span class="va">null.deviance</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 0.264315</span></span>
<span><span class="co"># [1] 0.2461561</span></span>
<span><span class="co"># 0.2461561 means that approximately 24.6% of the variability in the response</span></span>
<span><span class="co"># variable is explained by your model. This is relatively low, suggesting that the</span></span>
<span><span class="co"># model may not be capturing much of the underlying pattern in the data.</span></span>
<span></span>
<span><span class="co"># Model summary results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeta2</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm.cons(formula = zeta.val ~ ., family = family, data = data.tot, </span></span>
<span><span class="co">#&gt;     control = control, method = "glm.fit.cons", cons = cons, </span></span>
<span><span class="co">#&gt;     cons.inter = cons.inter)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.103685   0.007458  13.903  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; obs_sum1    -0.047222   0.003601 -13.112  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; obs_sum2     0.000000   0.016421   0.000 1.000000    </span></span>
<span><span class="co">#&gt; obs_sum3     0.000000   0.021894   0.000 1.000000    </span></span>
<span><span class="co">#&gt; temp_mean1   0.000000   0.035343   0.000 1.000000    </span></span>
<span><span class="co">#&gt; temp_mean2  -0.009559   0.012775  -0.748 0.454502    </span></span>
<span><span class="co">#&gt; temp_mean3   0.000000   0.015940   0.000 1.000000    </span></span>
<span><span class="co">#&gt; iso1        -0.004022   0.013746  -0.293 0.769874    </span></span>
<span><span class="co">#&gt; iso2         0.000000   0.009277   0.000 1.000000    </span></span>
<span><span class="co">#&gt; iso3         0.000000   0.013286   0.000 1.000000    </span></span>
<span><span class="co">#&gt; temp_wetQ1   0.000000   0.011252   0.000 1.000000    </span></span>
<span><span class="co">#&gt; temp_wetQ2  -0.004848   0.009588  -0.506 0.613246    </span></span>
<span><span class="co">#&gt; temp_wetQ3  -0.003618   0.013219  -0.274 0.784346    </span></span>
<span><span class="co">#&gt; temp_dryQ1  -0.005572   0.033097  -0.168 0.866337    </span></span>
<span><span class="co">#&gt; temp_dryQ2  -0.006185   0.010479  -0.590 0.555161    </span></span>
<span><span class="co">#&gt; temp_dryQ3   0.000000   0.011843   0.000 1.000000    </span></span>
<span><span class="co">#&gt; rain_dry1   -0.018325   0.007454  -2.458 0.014127 *  </span></span>
<span><span class="co">#&gt; rain_dry2    0.000000   0.009306   0.000 1.000000    </span></span>
<span><span class="co">#&gt; rain_dry3    0.000000   0.014403   0.000 1.000000    </span></span>
<span><span class="co">#&gt; rain_warmQ1 -0.002312   0.008321  -0.278 0.781217    </span></span>
<span><span class="co">#&gt; rain_warmQ2 -0.015782   0.010613  -1.487 0.137324    </span></span>
<span><span class="co">#&gt; rain_warmQ3  0.000000   0.020082   0.000 1.000000    </span></span>
<span><span class="co">#&gt; distance1   -0.040602   0.011229  -3.616 0.000315 ***</span></span>
<span><span class="co">#&gt; distance2    0.000000   0.011820   0.000 1.000000    </span></span>
<span><span class="co">#&gt; distance3   -0.013797   0.015469  -0.892 0.372669    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.001674497)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 2.2192  on 999  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 1.6326  on 975  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: -3527.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="id_14-predict-current-zeta-diversity-zeta2-using-predict_dissim">14. Predict current Zeta Diversity (zeta2) using <code>predict_dissim</code>
<a class="anchor" aria-label="anchor" href="#id_14-predict-current-zeta-diversity-zeta2-using-predict_dissim"></a>
</h3>
<ul>
<li><em>In the ‘sbe’ add ‘sam.max’, a constant for all sites = max(sam.eff)</em></li>
<li><em>Predict for the updated sbe and xy</em></li>
<li><em>Produce a site by site matrix of predicted zeta ‘zeta.now’</em></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predict current zeta diversity using `predict_dissim` with sampling effort, geographic distance and environmental variables</span></span>
<span><span class="co"># Only non-colinear environmental variables used in `zeta2` model</span></span>
<span><span class="va">predictors_df</span> <span class="op">=</span> <span class="fu"><a href="reference/predict_dissim.html">predict_dissim</a></span><span class="op">(</span></span>
<span>  block_sp   <span class="op">=</span> <span class="va">grid_spp</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  sbe        <span class="op">=</span> <span class="va">sbe</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>,<span class="co"># env_vars_reduced[,-8]</span></span>
<span>  zeta_model <span class="op">=</span> <span class="va">zeta2</span>,</span>
<span>  mean_rich  <span class="op">=</span> <span class="va">mean_rich_o1234</span>,</span>
<span>  mean_turn  <span class="op">=</span> <span class="va">mean_turn_o2345</span>,</span>
<span>  sbs_xy     <span class="op">=</span> <span class="va">xy</span>,</span>
<span>  x_col      <span class="op">=</span> <span class="st">"centroid_lon"</span>,</span>
<span>  y_col      <span class="op">=</span> <span class="st">"centroid_lat"</span>,</span>
<span>  rsa        <span class="op">=</span> <span class="va">rsa</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-predict-zeta2-1.png" width="100%"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">predictors_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 415  29</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictors_df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   obs_sum spp_rich temp_mean      mdr      iso temp_sea temp_max</span></span>
<span><span class="co">#&gt; 1       3        2  21.88425 14.47900 55.67347 427.1824   32.446</span></span>
<span><span class="co">#&gt; 2      41       31  21.76921 14.61358 53.90477 453.1160   32.977</span></span>
<span><span class="co">#&gt; 3      10       10  21.53492 14.00267 56.31250 392.8977   31.662</span></span>
<span><span class="co">#&gt; 4       7        7  23.01796 13.67825 57.83615 357.9102   32.791</span></span>
<span><span class="co">#&gt; 5       6        6  23.59879 13.83525 59.58590 334.4157   33.509</span></span>
<span><span class="co">#&gt; 6     107       76  24.57367 14.64933 61.67101 332.0319   34.788</span></span></code></pre></div>
<ul>
<li><em>Run nmds for the predicted zeta matrix</em></li>
<li><em>Plot RGB of the 3 component scores</em></li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="id_15-run-clustering-analyses-using-map_bioreg">15. Run clustering analyses using <code>map_bioreg</code>
<a class="anchor" aria-label="anchor" href="#id_15-run-clustering-analyses-using-map_bioreg"></a>
</h3>
<ul>
<li><em>Map bioregion clusters of current zeta2</em></li>
<li><em>Generate maps of dissimilarity (the rgb plot)</em></li>
<li><em>Generate map of bioregions (from clustering)</em></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run `map_bioreg` function to generate and plot clusters</span></span>
<span><span class="va">bioreg_result</span> <span class="op">=</span> <span class="fu"><a href="reference/map_bioreg.html">map_bioreg</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">predictors_df</span>,</span>
<span>  scale_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pred_zeta"</span>, <span class="st">"centroid_lon"</span>, <span class="st">"centroid_lat"</span><span class="op">)</span>,</span>
<span>  clus_method <span class="op">=</span> <span class="st">"all"</span>, <span class="co"># K-means, PAM, Hierarchical and GMM clustering</span></span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interp <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  x_col <span class="op">=</span><span class="st">'centroid_lon'</span>,</span>
<span>  y_col <span class="op">=</span><span class="st">'centroid_lat'</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; fitting ...</span></span>
<span><span class="co">#&gt;   |                                                                                                   |                                                                                           |   0%  |                                                                                                   |======                                                                                     |   7%  |                                                                                                   |============                                                                               |  13%  |                                                                                                   |==================                                                                         |  20%  |                                                                                                   |========================                                                                   |  27%  |                                                                                                   |==============================                                                             |  33%  |                                                                                                   |====================================                                                       |  40%  |                                                                                                   |==========================================                                                 |  47%  |                                                                                                   |=================================================                                          |  53%  |                                                                                                   |=======================================================                                    |  60%  |                                                                                                   |=============================================================                              |  67%  |                                                                                                   |===================================================================                        |  73%  |                                                                                                   |=========================================================================                  |  80%  |                                                                                                   |===============================================================================            |  87%  |                                                                                                   |=====================================================================================      |  93%  |                                                                                                   |===========================================================================================| 100%</span></span></code></pre></div>
<p><img src="reference/figures/README-zeta-cluster-1.png" width="100%"></p>
<hr>
</div>
<div class="section level3">
<h3 id="id_16-predict-future-zeta-diversity-and-map-bioregion-change-using-map_bioregdiff">16. Predict future Zeta Diversity and map bioregion change using <code>map_bioregDiff</code>
<a class="anchor" aria-label="anchor" href="#id_16-predict-future-zeta-diversity-and-map-bioregion-change-using-map_bioregdiff"></a>
</h3>
<ul>
<li><em>with appended (future scenarios) environmental variables and ‘sam.max’ in sbe</em></li>
<li><em>For m number of scenarios plus the present scenario (step 14) and n sites of xy</em></li>
<li><em>Updated sbe.future will have k = (m+1) x n number of rows</em></li>
<li><em>‘xy’ also updated with k rows</em></li>
<li><em>Predict a k by k matrix of predicted zeta ‘zeta.future’</em></li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># NOT RUN YET</span></span>
<span><span class="co"># future_df = predict_dissim(</span></span>
<span><span class="co">#   block_sp   = grid_spp[,-c(4:6)],</span></span>
<span><span class="co">#   sbe        = sbe[,-c(1:3)],</span></span>
<span><span class="co">#   zeta_model = zeta2,</span></span>
<span><span class="co">#   mean_rich  = mean_rich_o1234,</span></span>
<span><span class="co">#   mean_turn  = mean_turn_o2345,</span></span>
<span><span class="co">#   sbs_xy     = sbs_xy,</span></span>
<span><span class="co">#   x_col      = "centroid_lon",</span></span>
<span><span class="co">#   y_col      = "centroid_lat",</span></span>
<span><span class="co">#   rsa        = rsa</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="co"># Check results</span></span>
<span><span class="co"># dim(future_df)</span></span>
<span><span class="co"># head(future_df[,1:7])</span></span>
<span></span>
<span><span class="co"># Run `map_bioregDiff`</span></span>
<span><span class="co"># 'approach', specifies which metric to compute:</span></span>
<span><span class="co"># &gt;&gt; "difference_count": Counts cells with differing values across layers</span></span>
<span><span class="co"># &gt;&gt; "shannon_entropy": Calculates Shannon entropy, measuring diversity within layers</span></span>
<span><span class="co"># &gt;&gt; "stability": Identifies stable regions where values remain unchanged.</span></span>
<span><span class="co"># &gt;&gt; "transition_frequency": Quantifies the frequency of changes between layers</span></span>
<span><span class="co"># &gt;&gt; "weighted_change_index": Weighted score to changes based on a dissimilarity matrix</span></span>
<span><span class="co"># &gt;&gt; "all" (default): Returns all metrics as a combined SpatRaster</span></span>
<span></span>
<span><span class="va">result_bioregDiff</span> <span class="op">=</span> <span class="fu"><a href="reference/map_bioregDiff.html">map_bioregDiff</a></span><span class="op">(</span><span class="va">bioreg_result</span><span class="op">$</span><span class="va">clusters</span>, </span>
<span>                                   approach <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># See results</span></span>
<span><span class="va">result_bioregDiff</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 25, 32, 5  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.5, 0.4999984  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 16.75, 32.75, -34.75, -22.25004  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       : Differ~_Count, Shanno~ntropy, Stability, Transi~quency, Weight~_Index </span></span>
<span><span class="co">#&gt; min values  :             0,      0.000000,         0,             0,       0.00000 </span></span>
<span><span class="co">#&gt; max values  :             3,      1.039721,         1,             3,       2.52819</span></span>
<span></span>
<span><span class="co"># Mask `result_bioregDiff` to the RSA boundary</span></span>
<span><span class="va">mask_bioregDiff</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/resample.html" class="external-link">resample</a></span><span class="op">(</span><span class="va">result_bioregDiff</span>, <span class="va">grid_masked</span>, method <span class="op">=</span> <span class="st">"near"</span><span class="op">)</span>, <span class="va">grid_masked</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot all change results</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mask_bioregDiff</span>, col <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">100</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-predict-future-1.png" width="100%"></p>
<ul>
<li><em>Nmds of zeta.future</em></li>
<li><em>Clustering of zeta.future</em></li>
<li><em>Map sub matrices to indicate predicted future dissimilarity</em></li>
<li><em>Map predicted future bioregions</em></li>
<li>
<em>Map temporal turnover</em> <em>Note: step 14 is redundant if step 16 is needed</em><br><em>Note: step 16 has the same code but more results including those from step 6 but potentially computational demanding</em>
</li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="id_17-deposit-all-results-into-zenodo">17. Deposit all results into Zenodo<a class="anchor" aria-label="anchor" href="#id_17-deposit-all-results-into-zenodo"></a>
</h3>
<p>All data frames, tables, maps, and standard metadata can be deposited into Zenodo using <a href="https://github.com/eblondel/zen4R/wiki" class="external-link"><code>zen4R</code></a> or <a href="https://zenodo.org/records/10715460" class="external-link">Zenodo UI</a>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save(occ, sbs, sbe, zeta2, zeta_now, zeta_future, file="dissmapr_results.Rdata")</span></span>
<span><span class="co"># use zen4R or Zenodo UI to upload archive</span></span></code></pre></div>
<hr>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/macSands/dissmapr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/macSands/dissmapr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dissmapr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sandra MacFadyen <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://mybinder.org/v2/gh/nithecs-biomath/RBasicPack/master?urlpath=rstudio" class="external-link"><img src="https://mybinder.org/badge_logo.svg" alt="Binder"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/macSands/dissmapr/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/macSands/dissmapr/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
<li><a href="https://app.codecov.io/gh/macSands/dissmapr" class="external-link"><img src="https://codecov.io/gh/macSands/dissmapr/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/macSands/dissmapr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/macSands/dissmapr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sandra MacFadyen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
